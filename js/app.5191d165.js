(function(){"use strict";var e={469:function(e,t,s){s(8992),s(3949);var a=s(5130),o=s(6768),i=s(6450),n=s(8477);function l(e,t,s,a,l,r){const c=(0,o.g2)("router-view");return(0,o.uX)(),(0,o.Wv)(i.E,null,{default:(0,o.k6)((()=>[(0,o.bF)(n.Y,null,{default:(0,o.k6)((()=>[(0,o.bF)(c)])),_:1})])),_:1})}var r={name:"App",mounted(){this.preloadFonts()},methods:{preloadFonts(){const e=new FontFace("PixelFont","url(./assets/fonts/PixelFont.ttf)");e.load().then((e=>{document.fonts.add(e)})).catch((e=>{console.error("Error loading PixelFont:",e)}));const t=new FontFace("DigitalFont","url(./assets/fonts/DigitalFont.ttf)");t.load().then((e=>{document.fonts.add(e),console.log("DigitalFont loaded successfully")})).catch((e=>{console.error("Error loading DigitalFont:",e)}))}}},c=s(1241);const u=(0,c.A)(r,[["render",l]]);var d=u,m=s(1387),h=s(2807);const p={class:"home"},v={class:"logo-container"},g=["src"],f={class:"menu-container"};function y(e,t,a,i,n,l){return(0,o.uX)(),(0,o.CE)("div",p,[(0,o.Lk)("div",v,[(0,o.Lk)("img",{src:s(6178),alt:"Logo",class:"background-logo"},null,8,g),(0,o.Lk)("div",f,[(0,o.bF)(h.D,{color:"primary",size:"x-large",to:"/start-family",class:"menu-button",elevation:"4"},{default:(0,o.k6)((()=>t[0]||(t[0]=[(0,o.eW)(" Familiada ")]))),_:1}),(0,o.bF)(h.D,{color:"secondary",size:"x-large",to:"/politics",class:"menu-button",elevation:"4"},{default:(0,o.k6)((()=>t[1]||(t[1]=[(0,o.eW)(" Sejm ")]))),_:1})])])])}var b={name:"HomeView"};const w=(0,c.A)(b,[["render",y],["__scopeId","data-v-a4d9a31e"]]);var k=w,C=(s(3215),s(3462)),T=s(2729),L=s(3813),F=s(6756),_=s(5526);const x={class:"family-view"},S={ref:"videoPlayer",class:"background-video",autoplay:"",loop:"",muted:"",playsinline:""},z=["src"],P={style:{width:"100%",display:"flex","flex-direction":"column","align-items":"center",position:"relative"}},N={style:{width:"100%",display:"flex","flex-direction":"column","align-items":"center",position:"relative"}};function A(e,t,s,a,i,n){const l=(0,o.g2)("BuzzCompetition"),r=(0,o.g2)("RoundComplete"),c=(0,o.g2)("EndGame"),u=(0,o.g2)("SmallDigitalScreen"),d=(0,o.g2)("EventTeam"),m=(0,o.g2)("PlayerLabel"),h=(0,o.g2)("LossDigitalScreen"),p=(0,o.g2)("ResultDigitalScreen"),v=(0,o.g2)("GameTools");return(0,o.uX)(),(0,o.CE)("div",x,[(0,o.bF)(l,{modelValue:e.showBuzzCompetition,"onUpdate:modelValue":t[0]||(t[0]=t=>e.showBuzzCompetition=t),team1Name:e.team1Name,team2Name:e.team2Name,"bluetooth-characteristic":e.bluetoothCharacteristic,question:e.currentQuestion,answersCount:e.questionsData?.questions[e.currentQuestionIndex]?.answers?.length||0,showKeyboardHints:e.gameConfig?.showKeyboardHints,onTeamSelected:t[1]||(t[1]=t=>e.activeTeam=t),onShowQuestion:e.showQuestionOnBoard,onDialogClosed:e.handleBuzzClose},null,8,["modelValue","team1Name","team2Name","bluetooth-characteristic","question","answersCount","showKeyboardHints","onShowQuestion","onDialogClosed"]),(0,o.bF)(r,{modelValue:e.showPointsAnnouncement,"onUpdate:modelValue":[t[2]||(t[2]=t=>e.showPointsAnnouncement=t),e.handleRoundCompleteClose],points:e.currentPoints,teamName:1===e.pointsAnnouncementTeam?e.team1Name:e.team2Name,allAnswersRevealed:e.results.every((e=>e.pass)),totalLoss:e.team1Loss+e.team2Loss,victoryMethod:e.victoryMethod,isCheckingAnswers:e.isCheckingAnswers,isTeam1:1===e.pointsAnnouncementTeam,activeTeam:e.activeTeam,isLastRound:e.isLastRound,showKeyboardHints:e.gameConfig?.showKeyboardHints,onDialogOpened:e.handleDialogOpened,onDialogClosed:e.handleDialogClosed},null,8,["modelValue","points","teamName","allAnswersRevealed","totalLoss","victoryMethod","isCheckingAnswers","isTeam1","activeTeam","isLastRound","showKeyboardHints","onUpdate:modelValue","onDialogOpened","onDialogClosed"]),(0,o.bF)(c,{modelValue:e.showEndGame,"onUpdate:modelValue":t[3]||(t[3]=t=>e.showEndGame=t),team1Name:e.team1Name,team2Name:e.team2Name,team1Points:e.team1Points,team2Points:e.team2Points,endGameType:e.endGameType,totalRounds:e.round,showKeyboardHints:e.gameConfig?.showKeyboardHints},null,8,["modelValue","team1Name","team2Name","team1Points","team2Points","endGameType","totalRounds","showKeyboardHints"]),(0,o.Lk)("video",S,[(0,o.Lk)("source",{src:e.videoSrc,type:"video/mp4"},null,8,z)],512),(0,o.bF)(L.I,{class:"content-container flex-wrap"},{default:(0,o.k6)((()=>[(0,o.bF)(F.L,null,{default:(0,o.k6)((()=>[(0,o.bF)(_.B,{cols:"2"}),(0,o.bF)(_.B,{cols:"3"}),(0,o.bF)(_.B,{cols:"2",class:"d-flex justify-center"},{default:(0,o.k6)((()=>[e.multiplierPoints>1?((0,o.uX)(),(0,o.Wv)(C.Q,{key:0,content:`x${e.multiplierPoints}`,overlap:"true",bordered:"","offset-x":"30","offset-y":"30",class:"large-badge"},{default:(0,o.k6)((()=>[(0,o.bF)(u,{value:e.currentPoints,activeColor:1===e.activeTeam?"blue":2===e.activeTeam?"red":null},null,8,["value","activeColor"])])),_:1},8,["content"])):((0,o.uX)(),(0,o.Wv)(u,{key:1,value:e.currentPoints,activeColor:1===e.activeTeam?"blue":2===e.activeTeam?"red":null},null,8,["value","activeColor"]))])),_:1}),(0,o.bF)(_.B,{cols:"3"}),(0,o.bF)(_.B,{cols:"2"})])),_:1}),(0,o.bF)(F.L,null,{default:(0,o.k6)((()=>[(0,o.bF)(_.B,{cols:"12"},{default:(0,o.k6)((()=>[(0,o.bF)(F.L,null,{default:(0,o.k6)((()=>[(0,o.bF)(_.B,{cols:"2",class:"d-flex flex-column align-center large-badge"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",P,[(0,o.bF)(d,{teamNumber:1,team1Loss:e.team1Loss,team2Loss:e.team2Loss,victoryMethod:e.victoryMethod},null,8,["team1Loss","team2Loss","victoryMethod"]),(0,o.bF)(u,{value:e.team1Points},null,8,["value"]),(0,o.bF)(m,{playerNumber:"1",teamName:e.team1Name,isActive:1===e.activeTeam},null,8,["teamName","isActive"])])])),_:1}),(0,o.bF)(_.B,{cols:"8"},{default:(0,o.k6)((()=>[(0,o.bF)(T.J,{outlined:"",style:{"background-color":"#000",opacity:"0.88","background-image":"radial-gradient(#333 2px, transparent 3px)","background-size":"10px 10px","border-radius":"40px"}},{default:(0,o.k6)((()=>[(0,o.bF)(F.L,{"no-gutters":""},{default:(0,o.k6)((()=>[(0,o.bF)(_.B,{cols:"1",style:{"padding-left":"2em"}},{default:(0,o.k6)((()=>[(0,o.bF)(h,{myLoss:e.team1Loss,oponentLoss:e.team2Loss},null,8,["myLoss","oponentLoss"])])),_:1}),(0,o.bF)(_.B,{cols:"10"},{default:(0,o.k6)((()=>[(0,o.bF)(p,{question:e.question,results:e.results||[],"is-preparation-phase":e.isPreparationPhase},null,8,["question","results","is-preparation-phase"])])),_:1}),(0,o.bF)(_.B,{cols:"1",style:{"margin-left":"-2rem"}},{default:(0,o.k6)((()=>[(0,o.bF)(h,{myLoss:e.team2Loss,oponentLoss:e.team1Loss},null,8,["myLoss","oponentLoss"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,o.bF)(_.B,{cols:"2",class:"d-flex flex-column align-center"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",N,[(0,o.bF)(d,{teamNumber:2,team1Loss:e.team1Loss,team2Loss:e.team2Loss,victoryMethod:e.victoryMethod},null,8,["team1Loss","team2Loss","victoryMethod"]),(0,o.bF)(u,{value:e.team2Points},null,8,["value"]),(0,o.bF)(m,{playerNumber:"2",teamName:e.team2Name,isActive:2===e.activeTeam},null,8,["teamName","isActive"])])])),_:1})])),_:1})])),_:1})])),_:1}),(0,o.bF)(F.L,{class:"mt-n4"},{default:(0,o.k6)((()=>[(0,o.bF)(_.B,{cols:"12",class:"d-flex justify-center"},{default:(0,o.k6)((()=>[(0,o.bF)(_.B,{cols:"8"},{default:(0,o.k6)((()=>[(0,o.bF)(v,{onToolAction:e.handleToolAction,round:e.round,"current-points":Math.max(e.team1Points,e.team2Points),"answered-questions":e.currentQuestionIndex+1,"total-questions":e.questionsData?.questions?.length||0,"game-config":e.gameConfig,"is-preparation-phase":e.isPreparationPhase,"active-team":e.activeTeam,team1Loss:e.team1Loss,team2Loss:e.team2Loss,showKeyboardHints:e.gameConfig?.showKeyboardHints},null,8,["onToolAction","round","current-points","answered-questions","total-questions","game-config","is-preparation-phase","active-team","team1Loss","team2Loss","showKeyboardHints"])])),_:1})])),_:1})])),_:1})])),_:1})])}s(4114),s(4520),s(2577),s(1454),s(8872);var E=s(4232),I=s(8995);const R=["data-color"],B={class:"inner-container"};function V(e,t,s,a,i,n){return(0,o.uX)(),(0,o.CE)("div",{class:(0,E.C4)(["screen-container",{"animate-border":s.activeColor}]),"data-color":s.activeColor},[(0,o.Lk)("div",B,[(0,o.bF)(I.x,{density:"compact",class:"text-h1 py-16 d-flex justify-center digital-screen",style:{"background-color":"#000",color:"yellow","font-family":"'PixelFont'","background-image":"radial-gradient(#110 3px, transparent 1px)","background-size":"10px 10px","border-radius":"50px"}},{default:(0,o.k6)((()=>[(0,o.eW)((0,E.v_)(n.displayValue),1)])),_:1})])],10,R)}var D={name:"SmallDigitalScreen",props:{value:{type:[Number,String],required:!0,default:0},activeColor:{type:String,default:null,validator:e=>["blue","red",null].includes(e)}},computed:{displayValue(){return Number(this.value)>999?999:this.value}}};const W=(0,c.A)(D,[["render",V],["__scopeId","data-v-a271c0be"]]);var q=W,K=s(697);const j={class:"results-container"},O={class:"question-container"},M={class:"duplicate-text"},$={key:0,class:"duplicate-text"},Q={key:1,class:"duplicate-text"},Z={key:2,class:"duplicate-text"},G={class:"text-left",style:{width:"100%"}};function X(e,t,s,a,i,n){return(0,o.uX)(),(0,o.Wv)(T.J,{class:"pa-2",outlined:"",style:{height:"100%",width:"100%"},color:"transparent"},{default:(0,o.k6)((()=>[(0,o.bF)(K.O,{style:{color:"yellow","font-size":"3em","font-family":"'PixelFont'",height:"100%"}},{default:(0,o.k6)((()=>[(0,o.Lk)("div",j,[(0,o.bF)(F.L,{"no-gutters":"",class:"result-row flex-nowrap"},{default:(0,o.k6)((()=>[(0,o.bF)(_.B,{cols:"12",class:"text-center question-row marquee-wrapper"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",O,[(0,o.Lk)("div",{ref:"questionText",class:(0,E.C4)([{"scrolling-text":i.shouldScroll},"question-text"]),style:{"font-size":"smaller"}},[(0,o.Lk)("span",M,(0,E.v_)(s.question),1),i.shouldScroll?((0,o.uX)(),(0,o.CE)("span",$,(0,E.v_)(s.question),1)):(0,o.Q3)("",!0),i.shouldScroll?((0,o.uX)(),(0,o.CE)("span",Q,(0,E.v_)(s.question),1)):(0,o.Q3)("",!0),i.shouldScroll?((0,o.uX)(),(0,o.CE)("span",Z,(0,E.v_)(s.question),1)):(0,o.Q3)("",!0)],2)])])),_:1})])),_:1}),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(s.results,(e=>((0,o.uX)(),(0,o.Wv)(F.L,{key:e.id,"no-gutters":"",class:"result-row flex-nowrap"},{default:(0,o.k6)((()=>[(0,o.bF)(_.B,{cols:"2",class:"flex-grow-0 text-center"},{default:(0,o.k6)((()=>[(0,o.eW)((0,E.v_)(e.id),1)])),_:2},1024),(0,o.bF)(_.B,{cols:"8",class:"d-flex justify-center"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",G,[e.pass?((0,o.uX)(),(0,o.CE)("div",{key:0,class:(0,E.C4)(["answer-text",{"swipe-in":e.animated}])},[e.name.length>18?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.eW)((0,E.v_)(e.name.substring(0,18)+"."),1)],64)):((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[(0,o.eW)((0,E.v_)(e.name),1)],64))],2)):((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[(0,o.eW)(" ................................................ ")],64))])])),_:2},1024),(0,o.bF)(_.B,{cols:"2",class:"text-center"},{default:(0,o.k6)((()=>[e.pass?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.eW)((0,E.v_)(e.points),1)],64)):((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[(0,o.eW)(" -- ")],64))])),_:2},1024)])),_:2},1024)))),128)),(0,o.bF)(F.L,{"no-gutters":"",class:"result-row flex-nowrap"},{default:(0,o.k6)((()=>[(0,o.bF)(_.B,{cols:"12"},{default:(0,o.k6)((()=>t[0]||(t[0]=[(0,o.eW)(" ")]))),_:1})])),_:1}),(0,o.bF)(F.L,{"no-gutters":"",class:"result-row flex-nowrap"},{default:(0,o.k6)((()=>[(0,o.bF)(_.B,{cols:"6"}),(0,o.bF)(_.B,{cols:"4",class:"text-right"},{default:(0,o.k6)((()=>t[1]||(t[1]=[(0,o.eW)("SUMA:")]))),_:1}),(0,o.bF)(_.B,{cols:"2",class:"text-center"},{default:(0,o.k6)((()=>[(0,o.eW)((0,E.v_)(s.results.filter((e=>e.pass)).reduce(((e,t)=>e+t.points),0)),1)])),_:1})])),_:1}),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.getEmptyRowsCount(),(e=>((0,o.uX)(),(0,o.Wv)(F.L,{key:"empty-"+e,"no-gutters":"",class:"result-row flex-nowrap"},{default:(0,o.k6)((()=>[(0,o.bF)(_.B,{cols:"12"},{default:(0,o.k6)((()=>t[2]||(t[2]=[(0,o.eW)(" ")]))),_:1})])),_:1})))),128))])])),_:1})])),_:1})}s(7550);var U=s.p+"media/buzz.ec68965b.mp3",H=s.p+"media/bad.3a20615e.mp3",J=s.p+"media/good.a66fd463.mp3",Y=s.p+"media/intro.e69081f3.mp3",ee=s.p+"media/round.4bea5def.mp3",te=s.p+"media/win.a99fc810.mp3",se=s.p+"media/outro.3ca69ac6.mp3",ae=s.p+"media/clapping.b1295d10.mp3";function oe(){const e={buzz:new Audio(U),bad:new Audio(H),good:new Audio(J),intro:new Audio(Y),round:new Audio(ee),pause:new Audio(te),outro:new Audio(se),clapping:new Audio(ae)};Object.values(e).forEach((e=>{e.volume=.7}));const t=t=>{e[t]?(e[t].pause(),e[t].currentTime=0,e[t].play().catch((e=>{console.error(`Błąd odtwarzania dźwięku "${t}":`,e)}))):console.error(`Dźwięk "${t}" nie istnieje`)},s=()=>{Object.values(e).forEach((e=>{e.pause(),e.currentTime=0}))},a=t=>{const s=Math.max(0,Math.min(1,t));Object.values(e).forEach((e=>{e.volume=s}))};return{play:t,stopAll:s,setVolume:a,playBuzz:()=>t("buzz"),playBad:()=>t("bad"),playGood:()=>t("good"),playIntro:()=>t("intro"),playRound:()=>t("round"),playPause:()=>t("pause"),playOutro:()=>t("outro"),playClapping:()=>t("clapping")}}var ie={name:"FamilyResultDigitalScreen",setup(){const e=oe();return{audioManager:e}},data(){return{shouldScroll:!1,previousResults:[],animationTimeout:null}},props:{results:{type:Array,required:!0,default:()=>[]},question:{type:String,required:!0},isPreparationPhase:{type:Boolean,default:!1}},mounted(){window.addEventListener("resize",this.checkOverflow),this.$nextTick((()=>{this.checkOverflow()})),this.previousResults=JSON.parse(JSON.stringify(this.results))},beforeUnmount(){window.removeEventListener("resize",this.checkOverflow),clearTimeout(this.animationTimeout)},watch:{question:{immediate:!0,handler(){this.$nextTick((()=>{this.checkOverflow()}))}},results:{deep:!0,immediate:!0,handler(e){console.log("Results changed:",e),console.log("Results length:",e?.length);const t=e.filter((e=>e.pass&&!this.previousResults.some((t=>t.id===e.id&&t.pass)))),s=e.some((e=>e.loss&&!this.previousResults.some((t=>t.id===e.id&&t.loss))));s?(this.audioManager.playBad(),this.isPreparationPhase&&e.forEach((e=>{e.loss&&(e.loss=!1)}))):t.length>0&&(this.audioManager.playGood(),t.forEach((t=>{const s=e.findIndex((e=>e.id===t.id));-1!==s&&(e[s].animated=!0,clearTimeout(this.animationTimeout),this.animationTimeout=setTimeout((()=>{e.forEach((e=>{e.animated&&(e.animated=!1)}))}),1e3))}))),this.previousResults=JSON.parse(JSON.stringify(e))}}},methods:{getEmptyRowsCount(){console.log("Results length:",this.results?.length);const e=this.results?.length||0,t=Math.max(0,Math.min(6-e,6));return console.log("Empty rows to render:",t),t},checkOverflow(){const e=this.$refs.questionText,t=e?.parentElement;if(e&&t){const s=e.getBoundingClientRect().width,a=t.getBoundingClientRect().width;this.shouldScroll=s>a}}}};const ne=(0,c.A)(ie,[["render",X],["__scopeId","data-v-61f051de"]]);var le=ne;function re(e,t,s,a,i,n){return(0,o.uX)(),(0,o.Wv)(K.O,{style:(0,E.Tr)({color:"yellow",fontSize:"8em",fontFamily:"DigitalFont",opacity:.85,marginTop:"3rem",display:"inline-block",transformOrigin:"top",transform:`scaleY(${e.scaleYPropert})`,lineHeight:"0.9"})},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.myLoss,(t=>((0,o.uX)(),(0,o.CE)("span",{key:`my-${t}`,class:(0,E.C4)(["loss-x",{"swipe-down":e.isNewLoss(t)}])}," X ",2)))),128))])),_:1},8,["style"])}var ce=(0,o.pM)({name:"LossDigitalScreen",data(){return{previousLoss:0,animatedLosses:[],animationTimeout:null}},props:{myLoss:{type:Number,required:!0,validator:e=>e>=0&&e<=3},oponentLoss:{type:Number,default:0,validator:e=>e>=0&&e<=3}},mounted(){this.previousLoss=this.myLoss},beforeUnmount(){clearTimeout(this.animationTimeout)},watch:{myLoss(e,t){if(e>t){for(let s=t+1;s<=e;s++)this.animatedLosses.push(s);clearTimeout(this.animationTimeout),this.animationTimeout=setTimeout((()=>{this.animatedLosses=[]}),600)}this.previousLoss=e}},computed:{LostTakeover(){return 3===this.oponentLoss&&1===this.myLoss},scaleYPropert(){return this.LostTakeover?3.5:1.5}},methods:{isNewLoss(e){return this.animatedLosses.includes(e)}}});const ue=(0,c.A)(ce,[["render",re],["__scopeId","data-v-5a3fbc36"]]);var de=ue;const me=["data-player"];function he(e,t,s,a,i,n){return(0,o.uX)(),(0,o.CE)("div",{class:(0,E.C4)(["player-label",{active:e.isActive}]),"data-player":e.playerNumber},(0,E.v_)(e.teamName.toUpperCase()),11,me)}var pe=(0,o.pM)({name:"PlayerLabel",props:{playerNumber:{type:String,required:!0,validator:e=>["1","2"].includes(e)},teamName:{type:String,required:!0},isActive:{type:Boolean,default:!1}},computed:{playerColor(){return"1"===this.playerNumber?"blue":"red"}}});const ve=(0,c.A)(pe,[["render",he]]);var ge=ve,fe=s(1772),ye=s(1161);const be={class:"bold-number"};function we(e,t,s,i,n,l){return(0,o.uX)(),(0,o.Wv)(fe.p,{modelValue:l.dialog,"onUpdate:modelValue":t[2]||(t[2]=e=>l.dialog=e),width:"800",height:"500",persistent:""},{default:(0,o.k6)((()=>[(0,o.bF)(T.J,{class:"text-center",style:{"background-color":"#000","background-image":"radial-gradient(#333 2px, transparent 3px)","background-size":"10px 10px"}},{default:(0,o.k6)((()=>[(0,o.bF)(K.O,{class:"text-h4 pa-12",style:{color:"yellow","font-family":"'PixelFont'"}},{default:(0,o.k6)((()=>[(0,o.bF)(ye.y,{location:"top",text:"Buzz"},{activator:(0,o.k6)((({props:e})=>[n.questionShown?((0,o.uX)(),(0,o.CE)("span",(0,E._B)((0,o.v6)({key:1},e)),(0,E.v_)(s.question),17)):((0,o.uX)(),(0,o.CE)("span",(0,E._B)((0,o.v6)({key:0},e)),[t[3]||(t[3]=(0,o.eW)(" Pytanie z ")),(0,o.Lk)("span",be,(0,E.v_)(s.answersCount),1),t[4]||(t[4]=(0,o.eW)(" odpowiedziami "))],16)),t[5]||(t[5]=(0,o.Lk)("br",null,null,-1)),t[6]||(t[6]=(0,o.Lk)("br",null,null,-1))])),_:1}),(0,o.bF)(F.L,{class:"justify-center"},{default:(0,o.k6)((()=>[(0,o.bF)(_.B,{cols:"5"},{default:(0,o.k6)((()=>[(0,o.bF)(ye.y,{location:"top",text:s.showKeyboardHints?"[Lewy Shift]":"Buzz"},{activator:(0,o.k6)((({props:e})=>[(0,o.bF)(h.D,(0,o.v6)(e,{color:1===n.activeTeam?"#0000ff":"#66b3ff",class:["text-white","team-btn",{"v-btn--active":1===n.activeTeam}],style:{width:"100%",height:"100px"},onClick:t[0]||(t[0]=e=>l.selectTeam(1)),disabled:n.isBlocked&&1!==n.activeTeam}),{default:(0,o.k6)((()=>[(0,o.eW)((0,E.v_)(s.team1Name)+" ",1),t[7]||(t[7]=(0,o.Lk)("br",null,null,-1))])),_:2},1040,["color","class","disabled"])])),_:1},8,["text"])])),_:1}),(0,o.bF)(_.B,{cols:"5"},{default:(0,o.k6)((()=>[(0,o.bF)(ye.y,{location:"top",text:s.showKeyboardHints?"[Prawy Shift]":"Buzz"},{activator:(0,o.k6)((({props:e})=>[(0,o.bF)(h.D,(0,o.v6)(e,{color:2===n.activeTeam?"#ff0000":"#ff9999",class:["text-white","team-btn",{"v-btn--active":2===n.activeTeam}],style:{width:"100%",height:"100px"},onClick:t[1]||(t[1]=e=>l.selectTeam(2)),disabled:n.isBlocked&&2!==n.activeTeam}),{default:(0,o.k6)((()=>[(0,o.eW)((0,E.v_)(s.team2Name)+" ",1),t[8]||(t[8]=(0,o.Lk)("br",null,null,-1))])),_:2},1040,["color","class","disabled"])])),_:1},8,["text"])])),_:1})])),_:1}),(0,o.bF)(F.L,{class:"justify-center mb-6"},{default:(0,o.k6)((()=>[(0,o.bF)(_.B,{cols:"6"},{default:(0,o.k6)((()=>[(0,o.bF)(h.D,{class:"confirm-btn",onClick:l.handleConfirm,onKeyup:(0,a.jR)(l.handleConfirm,["enter"]),disabled:n.questionShown&&!n.activeTeam},{default:(0,o.k6)((()=>[(0,o.eW)((0,E.v_)(l.displayButtonText),1)])),_:1},8,["onClick","onKeyup","disabled"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])}var ke=s(144);function Ce(){const e=(0,ke.KR)(null),t=(0,ke.KR)(null),s=(0,ke.KR)(!1),a={49:2,50:1},o=async()=>{s.value=!1;try{if(e.value){await e.value.gatt.connect();const a=await e.value.gatt.getPrimaryService("0000ffe0-0000-1000-8000-00805f9b34fb");t.value=await a.getCharacteristic("0000ffe1-0000-1000-8000-00805f9b34fb"),await t.value.startNotifications(),s.value=!0}}catch(a){}},i=(e,t)=>{const s=e.target.value.getUint8(0);s in a&&t(a[s])},n=async a=>{if(window.bluetoothState&&(e.value=window.bluetoothState.device,t.value=window.bluetoothState.characteristic,s.value=window.bluetoothState.isConnected,t.value))try{if(!e.value.gatt.connected){await e.value.gatt.connect();const s=await e.value.gatt.getPrimaryService("0000ffe0-0000-1000-8000-00805f9b34fb");t.value=await s.getCharacteristic("0000ffe1-0000-1000-8000-00805f9b34fb")}return await t.value.startNotifications(),a&&t.value.addEventListener("characteristicvaluechanged",(e=>i(e,a))),e.value.addEventListener("gattserverdisconnected",o),!0}catch(n){return o(),!1}return!1},l=()=>{e.value&&e.value.removeEventListener("gattserverdisconnected",o)};return{bluetoothDevice:e,bluetoothCharacteristic:t,isBluetoothConnected:s,initializeBluetooth:n,cleanup:l,BUZZER_SIGNALS:a}}var Te={name:"BuzzCompetition",setup(){const{BUZZER_SIGNALS:e}=Ce(),t=oe();return{BUZZER_SIGNALS:e,audioManager:t}},data(){return{activeTeam:null,isBlocked:!1,questionShown:!1}},props:{modelValue:{type:Boolean,required:!0},team1Name:{type:String,required:!0},team2Name:{type:String,required:!0},bluetoothCharacteristic:{type:Object,default:null},question:{type:String,required:!0},answersCount:{type:Number,required:!0},showKeyboardHints:{type:Boolean,default:!1}},methods:{selectTeam(e){this.isBlocked||(this.activeTeam=e,this.isBlocked=!0,this.audioManager.stopAll(),this.audioManager.playBuzz(),this.$emit("team-selected",e),this.questionShown||(this.questionShown=!0))},closeDialog(){this.$emit("dialog-closed"),this.dialog=!1,this.isBlocked=!1},handleConfirm(){this.questionShown?this.activeTeam&&(this.$emit("show-question"),this.closeDialog()):this.questionShown=!0},handleKeyPress(e){this.dialog&&("Shift"!==e.key||this.isBlocked?"Enter"===e.key&&this.handleConfirm():1===e.location?this.selectTeam(1):2===e.location&&this.selectTeam(2))},handleBuzzerSignal(e){if(!this.dialog||this.isBlocked)return;const t=e.target.value.getUint8(0);t in this.BUZZER_SIGNALS&&this.selectTeam(this.BUZZER_SIGNALS[t])},resetState(){this.activeTeam=null,this.isBlocked=!1},fullReset(){this.resetState(),this.questionShown=!1}},watch:{dialog:{immediate:!0,handler(e){e?(this.fullReset(),this.audioManager.playRound(),this.bluetoothCharacteristic&&this.bluetoothCharacteristic.addEventListener("characteristicvaluechanged",this.handleBuzzerSignal)):(this.bluetoothCharacteristic&&this.bluetoothCharacteristic.removeEventListener("characteristicvaluechanged",this.handleBuzzerSignal),this.resetState())}}},mounted(){window.addEventListener("keydown",this.handleKeyPress)},beforeUnmount(){window.removeEventListener("keydown",this.handleKeyPress),this.bluetoothCharacteristic&&this.bluetoothCharacteristic.removeEventListener("characteristicvaluechanged",this.handleBuzzerSignal)},computed:{dialog:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},displayText(){return this.questionShown?this.question:`Pytanie z <span class="bold-number">${this.answersCount}</span> odpowiedziami`},displayButtonText(){const e=this.questionShown?"Dalej":"Pokaż pytanie";return this.showKeyboardHints?`${e} [Enter]`:e}}};const Le=(0,c.A)(Te,[["render",we],["__scopeId","data-v-15099d06"]]);var Fe=Le,_e=s(1606),xe=s(3745),Se=s(9669);const ze={class:"game-tools"},Pe={class:"round-label"},Ne={key:0,class:"game-progress"},Ae={class:"status-label"};function Ee(e,t,s,a,i,n){return(0,o.uX)(),(0,o.CE)("div",ze,[(0,o.bF)(F.L,{"no-gutters":""},{default:(0,o.k6)((()=>[(0,o.bF)(_.B,{cols:"3",class:"d-flex align-center"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",Pe,[(0,o.eW)(" Runda "+(0,E.v_)(s.round)+" ",1),n.showProgress?((0,o.uX)(),(0,o.CE)("div",Ne,(0,E.v_)(n.progressText),1)):(0,o.Q3)("",!0)])])),_:1}),(0,o.bF)(_.B,{cols:"6",class:"d-flex justify-center align-center",style:{gap:"48px"}},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.tools,((e,t)=>((0,o.uX)(),(0,o.Wv)(h.D,{key:t,color:e.color,icon:"",size:"x-large",variant:"tonal",class:"d-flex align-center justify-center",onClick:t=>n.handleToolClick(e.action)},{default:(0,o.k6)((()=>[(0,o.bF)(Se.w,{icon:e.icon,size:"32",class:"d-flex align-center justify-center"},null,8,["icon"]),(0,o.bF)(ye.y,{activator:"parent",location:"top"},{default:(0,o.k6)((()=>[(0,o.eW)((0,E.v_)(e.tooltip),1)])),_:2},1024)])),_:2},1032,["color","onClick"])))),128))])),_:1}),(0,o.bF)(_.B,{cols:"3",class:"d-flex align-center"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",Ae,(0,E.v_)(n.statusGame),1)])),_:1})])),_:1}),(0,o.bF)(fe.p,{modelValue:i.showResetDialog,"onUpdate:modelValue":t[1]||(t[1]=e=>i.showResetDialog=e),"max-width":"400",onKeydown:n.handleResetDialogKeyPress},{default:(0,o.k6)((()=>[(0,o.bF)(T.J,{class:"text-center"},{default:(0,o.k6)((()=>[(0,o.bF)(_e.r,{class:"text-h5 font-weight-bold pa-4"},{default:(0,o.k6)((()=>t[2]||(t[2]=[(0,o.eW)(" Resetowanie gry ")]))),_:1}),(0,o.bF)(K.O,{class:"pa-4"},{default:(0,o.k6)((()=>t[3]||(t[3]=[(0,o.eW)(" Czy na pewno chcesz zresetować grę? Wszystkie postępy zostaną utracone. ")]))),_:1}),(0,o.bF)(xe.S,{class:"justify-center pa-4 gap-4"},{default:(0,o.k6)((()=>[(0,o.bF)(h.D,{"min-width":"120",color:"red",variant:"flat",onClick:n.confirmReset,class:"reset-btn"},{default:(0,o.k6)((()=>[(0,o.eW)((0,E.v_)(s.showKeyboardHints?"Tak [Enter]":"Tak"),1)])),_:1},8,["onClick"]),(0,o.bF)(h.D,{"min-width":"120",color:"grey",variant:"flat",onClick:t[0]||(t[0]=e=>i.showResetDialog=!1),class:"reset-btn"},{default:(0,o.k6)((()=>[(0,o.eW)((0,E.v_)(s.showKeyboardHints?"Anuluj [0]":"Anuluj"),1)])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue","onKeydown"])])}var Ie={name:"GameTools",setup(){const e=oe();return{audioManager:e}},props:{round:{type:Number,required:!0},currentPoints:{type:Number,default:0},totalQuestions:{type:Number,default:0},answeredQuestions:{type:Number,default:0},gameConfig:{type:Object,required:!0},isPreparationPhase:{type:Boolean,default:!1},activeTeam:{type:Number,default:null},isTeamConsulting:{type:Boolean,default:!1},team1Loss:{type:Number,default:0},team2Loss:{type:Number,default:0},showKeyboardHints:{type:Boolean,default:!1}},data(){return{showResetDialog:!1}},computed:{showProgress(){return"all"!==this.gameConfig?.gameEndCondition},progressText(){return this.gameConfig?"points"===this.gameConfig.gameEndCondition?`${this.currentPoints}/${this.gameConfig.gameEndLimit} pkt`:`${this.answeredQuestions}/${this.gameConfig.gameEndLimit} pytań`:""},roundLabel(){let e=`Runda ${this.round}`;return this.isPreparationPhase&&(e+=" - Wybór Drużyny"),e},statusGame(){return this.isPreparationPhase?"Wybór Drużyny":1===this.activeTeam&&2===this.team1Loss||2===this.activeTeam&&2===this.team2Loss?"NARADA":1===this.activeTeam&&3===this.team2Loss||2===this.activeTeam&&3===this.team1Loss?"PRÓBA PRZEJĘCIA":""},tools(){return[{icon:"mdi-swap-horizontal",color:"green",tooltip:this.showKeyboardHints?"Zmiana drużyny [/]":"Zmiana drużyny",action:"swap",shortcut:"/"},{icon:"mdi-timer",color:"orange",tooltip:this.showKeyboardHints?"Start/Stop timer [-]":"Start/Stop timer",action:"timer",shortcut:"-"},{icon:"mdi-numeric",color:"yellow",tooltip:this.showKeyboardHints?"Zmień punktowanie [+]":"Zmień punktowanie",action:"points",shortcut:"+"},{icon:"mdi-restart",color:"red",tooltip:this.showKeyboardHints?"Zacznij od nowa [Backspace]":"Zacznij od nowa",action:"restart",shortcut:"Backspace"}]}},mounted(){window.addEventListener("keydown",this.handleKeyPress)},beforeUnmount(){window.removeEventListener("keydown",this.handleKeyPress)},methods:{handleToolClick(e){"restart"===e?this.showResetDialog=!0:"loss"===e?(this.audioManager.playBad(),this.$emit("tool-action",e)):this.$emit("tool-action",e)},handleResetDialogKeyPress(e){"Enter"===e.key?this.confirmReset():"0"!==e.key&&"Numpad0"!==e.key||(this.showResetDialog=!1)},confirmReset(){localStorage.removeItem("familyGameConfig"),this.$emit("tool-action","restart"),this.showResetDialog=!1,this.$router.push("/start-family")},handleKeyPress(e){const t={"/":"swap","-":"timer","+":"points",Backspace:"restart",NumpadDivide:"swap",NumpadSubtract:"timer",NumpadAdd:"points",0:"loss",Numpad0:"loss"},s=e.key;if(/^[1-9]$/.test(s)||/^Numpad[1-9]$/.test(e.code)){const t=parseInt(s)||parseInt(e.code.slice(-1));return void this.$emit("tool-action",`show-answer-${t}`)}const a=t[e.key]||t[e.code];a&&this.handleToolClick(a)}}};const Re=(0,c.A)(Ie,[["render",Ee],["__scopeId","data-v-4dc71534"]]);var Be=Re;const Ve={class:"points-display"},De={class:"points"},We={key:1,class:"draw-text"};function qe(e,t,s,a,i,n){return s.modelValue?((0,o.uX)(),(0,o.Wv)(fe.p,{key:0,"model-value":!0,width:"600",persistent:"",class:(0,E.C4)({"round-complete-dialog-top":n.shouldShowAtTop})},{activator:(0,o.k6)((({props:e})=>[(0,o.Lk)("div",(0,E._B)((0,o.Ng)(e)),null,16)])),default:(0,o.k6)((()=>[(0,o.bF)(T.J,{class:"text-center",style:{"background-color":"#000","background-image":"radial-gradient(#333 2px, transparent 3px)","background-size":"10px 10px"}},{default:(0,o.k6)((()=>[(0,o.bF)(K.O,{class:"text-h2 pa-12",style:{color:"yellow","font-family":"'PixelFont'"}},{default:(0,o.k6)((()=>[(0,o.Lk)("div",Ve,[s.points>0&&null!=s.activeTeam?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.Lk)("div",De,"+"+(0,E.v_)(s.points),1),(0,o.Lk)("div",{class:(0,E.C4)(["team-name",{"team-blue":s.isTeam1,"team-red":!s.isTeam1}])},(0,E.v_)(s.teamName),3)],64)):0===s.points&&null!=s.activeTeam?((0,o.uX)(),(0,o.CE)("div",We,"Remis")):(0,o.Q3)("",!0),(0,o.bF)(h.D,{class:"mt-6 confirm-btn",onClick:n.closeDialog,style:{width:"100%"}},{default:(0,o.k6)((()=>[(0,o.eW)((0,E.v_)(n.buttonText),1)])),_:1},8,["onClick"])])])),_:1})])),_:1})])),_:1},8,["class"])):(0,o.Q3)("",!0)}var Ke={name:"RoundComplete",props:{modelValue:{type:Boolean,required:!0},activeTeam:{type:Number,default:null},points:{type:Number,required:!0},teamName:{type:String,required:!0},allAnswersRevealed:{type:Boolean,required:!0},totalLoss:{type:Number,required:!0,default:0},victoryMethod:{type:Number,default:null},isCheckingAnswers:{type:Boolean,default:!1},isTeam1:{type:Boolean,default:!0},isLastRound:{type:Boolean,default:!1},showKeyboardHints:{type:Boolean,default:!1}},data(){return{isVisible:!1}},computed:{buttonText(){const e=this.allAnswersRevealed?this.isLastRound?"Przejdź do podsumowania":"Następna runda":"Sprawdź odpowiedzi";return this.showKeyboardHints?`${e} [enter]`:e},shouldShowAtTop(){return this.allAnswersRevealed&&null==this.activeTeam}},methods:{handleClose(){this.$emit("update:modelValue",!1),this.$emit("dialogClosed",this.allAnswersRevealed)},closeDialog(){this.handleClose()}},mounted(){this.handleKeyUp=e=>{"Enter"===e.key&&this.modelValue&&(e.preventDefault(),this.closeDialog())},window.addEventListener("keyup",this.handleKeyUp),this.modelValue&&this.$emit("dialogOpened")},watch:{modelValue(e){e&&this.$emit("dialogOpened")}},beforeUnmount(){window.removeEventListener("keyup",this.handleKeyUp)}};const je=(0,c.A)(Ke,[["render",qe],["__scopeId","data-v-ba2708c4"]]);var Oe=je;const Me={class:"event-team"};function $e(e,t,s,i,n,l){return(0,o.uX)(),(0,o.CE)("div",Me,[(0,o.bF)(a.eB,{name:"alert-fade"},{default:(0,o.k6)((()=>[l.showAlert?((0,o.uX)(),(0,o.CE)("div",{key:0,class:(0,E.C4)(["alert-label",{przejecie:l.showPrzejecie,narada:!l.showPrzejecie}])},(0,E.v_)(l.alertText),3)):(0,o.Q3)("",!0)])),_:1})])}var Qe={name:"EventTeam",props:{teamNumber:{type:Number,required:!0,validator:e=>[1,2].includes(e)},team1Loss:{type:Number,default:0},team2Loss:{type:Number,default:0},victoryMethod:{type:Number,default:null}},computed:{showNarada(){return 1===this.teamNumber?2===this.team2Loss&&null===this.victoryMethod:2===this.team1Loss&&null===this.victoryMethod},showPrzejecie(){return 1===this.teamNumber?3===this.team2Loss&&null===this.victoryMethod:3===this.team1Loss&&null===this.victoryMethod},showAlert(){return this.showNarada||this.showPrzejecie},alertText(){return this.showPrzejecie?"PRÓBA PRZEJĘCIA":"NARADA"}}};const Ze=(0,c.A)(Qe,[["render",$e],["__scopeId","data-v-84bd71aa"]]);var Ge=Ze;const Xe={class:"victory-text"},Ue={class:"points-summary"},He={class:(0,E.C4)({"text-blue":!0})},Je={class:(0,E.C4)({"text-red":!0})},Ye={class:"rounds-info"},et={class:"game-info"};function tt(e,t,s,a,i,n){return(0,o.uX)(),(0,o.Wv)(fe.p,{modelValue:n.dialogVisible,"onUpdate:modelValue":t[0]||(t[0]=e=>n.dialogVisible=e),width:"800",persistent:"","content-class":"end-game-dialog"},{default:(0,o.k6)((()=>[(0,o.bF)(T.J,{class:"text-center",style:{"background-color":"#000","background-image":"radial-gradient(#333 2px, transparent 3px)","background-size":"10px 10px"}},{default:(0,o.k6)((()=>[(0,o.bF)(K.O,{class:"pa-12"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",Xe,(0,E.v_)(n.gameResultText),1),(0,o.Lk)("div",{class:(0,E.C4)(["winner-name",{"team-blue":n.isTeam1Winner,"team-red":!n.isTeam1Winner&&!n.isDraw,"team-draw":n.isDraw}])},(0,E.v_)(n.winnerName),3),(0,o.Lk)("div",Ue,[(0,o.Lk)("div",He,(0,E.v_)(s.team1Name)+": "+(0,E.v_)(s.team1Points),1),(0,o.Lk)("div",Je,(0,E.v_)(s.team2Name)+": "+(0,E.v_)(s.team2Points),1)]),(0,o.Lk)("div",Ye," Rozegrane rundy: "+(0,E.v_)(s.totalRounds),1),(0,o.Lk)("div",et,(0,E.v_)(n.endGameReason),1),(0,o.bF)(h.D,{class:"mt-6 confirm-btn",onClick:n.cleanupAndNavigate,style:{width:"100%"}},{default:(0,o.k6)((()=>[(0,o.eW)((0,E.v_)(n.buttonText),1)])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])}var st=s(8446),at={name:"EndGame",props:{modelValue:Boolean,team1Name:String,team2Name:String,team1Points:Number,team2Points:Number,totalRounds:{type:Number,default:0},endGameType:{type:String,validator:e=>["questions","points","rounds"].includes(e)},showKeyboardHints:{type:Boolean,default:!1}},setup(){const e=(0,m.rd)(),t=oe();return{router:e,audioManager:t}},computed:{dialogVisible:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}},isTeam1Winner(){return this.team1Points>this.team2Points},isDraw(){return this.team1Points===this.team2Points},gameResultText(){return this.isDraw?"Remis!":"Zwycięstwo!"},winnerName(){return this.isDraw?"Obie drużyny":this.isTeam1Winner?this.team1Name:this.team2Name},endGameReason(){if("questions"===this.endGameType)return"Wykorzystano wszystkie dostępne pytania!";switch(this.endGameType){case"points":return"Osiągnięto limit punktów!";case"rounds":return"Osiągnięto limit rund!";default:return""}},buttonText(){return this.showKeyboardHints?"Powrót do menu [enter]":"Powrót do menu"}},data(){return{animationFrameId:null,myConfetti:null,isAnimating:!1}},mounted(){window.addEventListener("keyup",this.handleKeyUp)},beforeUnmount(){this.isAnimating=!1,this.myConfetti&&(this.myConfetti.reset(),this.myConfetti=null),this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null),window.removeEventListener("keyup",this.handleKeyUp)},methods:{handleKeyUp(e){"Enter"===e.key&&this.modelValue&&this.stopConfettiAndNavigate()},stopConfettiAndNavigate(){this.isAnimating=!1,this.audioManager.stopAll(),this.myConfetti&&(this.myConfetti.reset(),this.myConfetti=null),this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null);const e=document.querySelectorAll("canvas");e.forEach((e=>e.remove())),setTimeout((()=>{window.location.href="/",window.location.reload()}),100)},cleanupAndNavigate(){this.audioManager.stopAll(),window.location.replace("/"),window.location.reload(!0)},fireConfetti(){if(this.isAnimating)return;this.isAnimating=!0;const e=document.createElement("canvas");e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.pointerEvents="none",e.style.zIndex="100000",document.body.appendChild(e),this.myConfetti=st.A.create(e,{resize:!0,useWorker:!0});const t=6e3,s=Date.now()+t,a=this.isDraw?["#FFD700","#ffffff","#FFA500"]:this.isTeam1Winner?["#0000ff","#ffffff","#4169E1"]:["#ff0000","#ffffff","#FF4500"],o=()=>{this.isAnimating&&(this.myConfetti({particleCount:8,angle:60,spread:70,origin:{x:0},colors:a,gravity:.8,scalar:1.5,zIndex:1e5}),this.myConfetti({particleCount:8,angle:120,spread:70,origin:{x:1},colors:a,gravity:.8,scalar:1.5,zIndex:1e5}),Date.now()<s&&this.isAnimating&&(this.animationFrameId=requestAnimationFrame(o)))};o()}},watch:{modelValue(e){e&&this.$nextTick((()=>{this.fireConfetti(),this.audioManager.stopAll(),this.audioManager.playOutro()}))}}};const ot=(0,c.A)(at,[["render",tt],["__scopeId","data-v-7abda640"]]);var it=ot,nt=s.p+"media/background.10a620ef.mp4",lt=(0,o.pM)({name:"FamilyView",components:{SmallDigitalScreen:q,ResultDigitalScreen:le,LossDigitalScreen:de,PlayerLabel:ge,BuzzCompetition:Fe,GameTools:Be,RoundComplete:Oe,EventTeam:Ge,EndGame:it},setup(){const{bluetoothDevice:e,bluetoothCharacteristic:t,isBluetoothConnected:s,initializeBluetooth:a,cleanup:o}=Ce(),i=oe();return{bluetoothDevice:e,bluetoothCharacteristic:t,isBluetoothConnected:s,initializeBluetooth:a,cleanup:o,audioManager:i}},data(){return{videoSrc:nt,gameConfig:null,question:"",showBuzzCompetition:!1,showPointsAnnouncement:!1,pointsAnnouncementTeam:null,team1Name:"",team2Name:"",questionsData:null,currentQuestionIndex:0,activeTeam:null,multiplierPoints:1,results:[],currentSumPoints:0,round:1,team1Points:0,team2Points:0,team1Loss:0,team2Loss:0,roundCompleted:!1,victoryMethod:null,isCheckingAnswers:!1,showEndGame:!1,endGameType:null,isLastRound:!1,currentQuestion:"",isPreparationPhase:!1,preparationPhaseTeam1Score:null,preparationPhaseTeam2Score:null,syncChannel:null}},computed:{currentPoints(){const e=this.results.filter((e=>e.pass)).reduce(((e,t)=>e+t.points),0);return e*this.multiplierPoints}},async created(){this.audioManager.stopAll();const e=localStorage.getItem("familyGameConfig");if(e)try{const t=JSON.parse(e);if(!Array.isArray(t.questionsData))throw new Error("Brak pytań w pliku");this.team1Name=t.team1Name,this.team2Name=t.team2Name,this.questionsData={questions:t.questionsData},this.gameConfig=t,this.initSyncChannel(),this.loadQuestion(0),t.isBluetoothConnected&&await this.initializeBluetooth()}catch(t){this.$router.push("/start-family")}else this.$router.push("/start-family")},mounted(){const e=this.$refs.videoPlayer;e&&(e.muted=!0)},methods:{loadQuestion(e){if(!this.checkGameEndCondition())if(this.questionsData?.questions?.[e]){this.currentQuestionIndex=e,this.currentSumPoints=0,this.gameConfig?.autoIncreaseMultiplier?this.multiplierPoints=e>=4?3:3===e?2:1:this.multiplierPoints=1,this.victoryMethod=null,this.isCheckingAnswers=!1,this.roundCompleted=!1,this.activeTeam=null,this.question="";const t=this.questionsData.questions[e];if(this.currentQuestion=t.question,!t?.answers||!Array.isArray(t.answers))return console.error("Brak poprawnych odpowiedzi dla pytania:",e),void(this.results=[]);this.results=t.answers.map(((e,t)=>({id:t+1,name:"",points:e.points||0,pass:!1}))),this.round=e+1,this.isPreparationPhase=!0,this.preparationPhaseTeam1Score=null,this.preparationPhaseTeam2Score=null,this.syncState(),setTimeout((()=>{this.showBuzzCompetition=!0}),500)}else"all"===this.gameConfig.gameEndCondition&&(this.showEndGame=!0,this.endGameType="questions")},showQuestionOnBoard(){const e=this.questionsData.questions[this.currentQuestionIndex];if(!e?.answers||!Array.isArray(e.answers))return console.error("Brak poprawnych odpowiedzi dla pytania:",this.currentQuestionIndex),void(this.results=[]);this.question=this.currentQuestion;try{const t=e.answers.map(((e,t)=>({id:t+1,name:e.answer||"",points:e.points||0,pass:!1})));t.length>0&&t.length<=10?(this.results=t,this.syncState()):(console.error("Nieprawidłowa liczba odpowiedzi:",t.length),this.results=[])}catch(t){console.error("Błąd podczas tworzenia tablicy wyników:",t),this.results=[]}},handleToolAction(e){if(!this.showPointsAnnouncement&&!this.showBuzzCompetition){if("loss"===e&&this.isPreparationPhase&&this.activeTeam){const e=this.activeTeam,t=1===e?2:1,s=1===e?this.preparationPhaseTeam1Score:this.preparationPhaseTeam2Score,a=1===e?this.preparationPhaseTeam2Score:this.preparationPhaseTeam1Score;if(null===s&&null===a)return 1===e?this.preparationPhaseTeam1Score=0:this.preparationPhaseTeam2Score=0,null===a?void(this.activeTeam=t):a>0?(this.isPreparationPhase=!1,void(this.activeTeam=t)):void(this.activeTeam=t)}if(e.startsWith("show-answer-")){if(!this.activeTeam&&!this.roundCompleted&&!this.victoryMethod)return;const t=parseInt(e.split("-").pop()),s=this.results.find((e=>e.id===t));if(s&&!s.pass){const e=this.results.indexOf(s);if(this.results[e]={...s,pass:!0},this.isPreparationPhase){const e=this.activeTeam,t=s.points,a=1===e?2:1;1===e?this.preparationPhaseTeam1Score=t:this.preparationPhaseTeam2Score=t;const o=this.results.reduce(((e,t)=>t.points>e.points?t:e));if(s.id===o.id)return this.isPreparationPhase=!1,void(this.activeTeam=e);const i=1===e?this.preparationPhaseTeam2Score:this.preparationPhaseTeam1Score;return null===i&&t>0?void(this.activeTeam=a):null!==i&&i>0?(this.isPreparationPhase=!1,void(this.activeTeam=t>i?e:a)):null!==i&&0===i&&t>0?(this.isPreparationPhase=!1,void(this.activeTeam=e)):void(t>0?(this.isPreparationPhase=!1,this.activeTeam=e):this.activeTeam=a)}null===this.victoryMethod&&(this.currentSumPoints=this.results.filter((e=>e.pass)).reduce(((e,t)=>e+t.points),0),(3===this.team1Loss||3===this.team2Loss)&&s.points>0&&(this.victoryMethod=3,1===this.activeTeam?(this.team1Points+=this.currentPoints,this.pointsAnnouncementTeam=1):(this.team2Points+=this.currentPoints,this.pointsAnnouncementTeam=2),this.showPointsAnnouncement=!0)),this.results.every((e=>e.pass))&&(2===this.victoryMethod||3===this.victoryMethod?this.showPointsAnnouncement=!0:null===this.victoryMethod&&(this.victoryMethod=1,1===this.activeTeam?this.team1Points+=this.currentPoints:this.team2Points+=this.currentPoints,this.pointsAnnouncementTeam=this.activeTeam,setTimeout((()=>{this.showPointsAnnouncement=!0}),1e3)))}}else switch(e){case"buzz":if(this.showPointsAnnouncement)return;this.showBuzzCompetition=!0,this.activeTeam=null;break;case"swap":this.activeTeam&&(this.activeTeam=1===this.activeTeam?2:1);break;case"restart":break;case"timer":break;case"points":if(this.showPointsAnnouncement)return;this.multiplierPoints=3===this.multiplierPoints?1:this.multiplierPoints+1;break;case"loss":if(this.showPointsAnnouncement||this.showBuzzCompetition)return;if(!this.activeTeam)return;if(this.team1Loss+this.team2Loss>=4)return;if(this.isPreparationPhase){const e=1===this.activeTeam?this.preparationPhaseTeam1Score:this.preparationPhaseTeam2Score,t=1===this.activeTeam?this.preparationPhaseTeam2Score:this.preparationPhaseTeam1Score;if(null===e&&null===t)return}if(1===this.activeTeam){if(this.team1Loss++,this.team1Loss+this.team2Loss>=4)return void this.checkLossCondition();3===this.team1Loss&&(this.activeTeam=2)}else if(2===this.activeTeam){if(this.team2Loss++,this.team1Loss+this.team2Loss>=4)return void this.checkLossCondition();3===this.team2Loss&&(this.activeTeam=1)}break;case"undo-loss":if(this.showPointsAnnouncement||this.showBuzzCompetition)return;if(!this.activeTeam)return;if(1===this.activeTeam){if(this.team1Loss>0){const e=3===this.team1Loss;this.team1Loss--,e&&2===this.team1Loss&&(this.activeTeam=2)}}else if(2===this.activeTeam&&this.team2Loss>0){const e=3===this.team2Loss;this.team2Loss--,e&&2===this.team2Loss&&(this.activeTeam=1)}break}}},checkLossCondition(){const e=this.team1Loss+this.team2Loss;e>=4&&null===this.victoryMethod&&(this.roundCompleted=!0,this.victoryMethod=2,this.currentPoints>0?1===this.activeTeam?(this.team2Points+=this.currentPoints,this.pointsAnnouncementTeam=2):(this.team1Points+=this.currentPoints,this.pointsAnnouncementTeam=1):this.pointsAnnouncementTeam=this.activeTeam,this.showPointsAnnouncement=!0)},handleRoundCompleteClose(e){this.showPointsAnnouncement=e,e||(this.isLastRound?this.results.every((e=>e.pass))?setTimeout((()=>{this.showEndGame=!0,this.endGameType=this.gameConfig.gameEndCondition}),100):this.activeTeam=null:this.results.every((e=>e.pass))&&Array.isArray(this.results)&&this.results.length>0&&this.resetRound(),this.activeTeam=null)},resetRound(){this.currentSumPoints=0,this.multiplierPoints=1,this.victoryMethod=null,this.isCheckingAnswers=!1,this.roundCompleted=!1,this.showPointsAnnouncement=!1,this.results=[],this.team1Loss=0,this.team2Loss=0,this.loadQuestion(this.currentQuestionIndex+1)},handleDialogOpened(){this.audioManager.stopAll(),setTimeout((()=>{this.audioManager.playPause()}),100)},handleDialogClosed(e){e&&this.audioManager.stopAll()},handleEndGameClose(){this.showEndGame=!1,this.$router.push("/start-family")},checkGameEndCondition(){if(!this.gameConfig)return!1;const e=Math.max(this.team1Points,this.team2Points);let t=!1;switch(this.gameConfig.gameEndCondition){case"points":e>=this.gameConfig.gameEndLimit&&(this.isLastRound=!0,this.endGameType="points",t=!0);break;case"questions":this.currentQuestionIndex+1>=this.gameConfig.gameEndLimit&&(this.isLastRound=!0,this.endGameType="rounds",t=!0);break}const s=this.currentQuestionIndex+1>=(this.questionsData?.questions?.length||0);return s&&!t?(this.isLastRound=!0,this.endGameType="questions",!0):t},handleBuzzClose(){this.showBuzzCompetition=!1},initSyncChannel(){this.syncChannel=new BroadcastChannel("family-game-sync"),this.syncChannel.onmessage=e=>{"action"===e.data.type&&this.handleToolAction(e.data.action)}},syncState(){if(this.syncChannel)try{let t=[];this.results&&Array.isArray(this.results)&&(t=this.results.map((e=>({id:Number(e.id)||0,name:String(e.name||""),points:Number(e.points)||0,pass:Boolean(e.pass)||!1}))));const s={currentQuestion:String(this.currentQuestion||""),question:String(this.question||""),results:t,round:Number(this.round||1),currentPoints:Number(this.currentPoints||0),activeTeam:null!==this.activeTeam&&void 0!==this.activeTeam?Number(this.activeTeam):null,currentQuestionIndex:Number(this.currentQuestionIndex||0),multiplierPoints:Number(this.multiplierPoints||1),team1Loss:Number(this.team1Loss||0),team2Loss:Number(this.team2Loss||0),team1Name:String(this.team1Name||""),team2Name:String(this.team2Name||"")};try{localStorage.setItem("familyGameState",JSON.stringify(s))}catch(e){console.warn("Nie udało się zapisać stanu do localStorage:",e)}const a=JSON.parse(JSON.stringify({type:"state-update",state:s}));this.syncChannel.postMessage(a)}catch(e){console.error("Błąd podczas synchronizacji stanu:",e)}}},beforeUnmount(){this.cleanup(),this.syncChannel&&this.syncChannel.close()},watch:{team1Loss(){this.checkLossCondition(),this.syncState()},team2Loss(){this.checkLossCondition(),this.syncState()},results:{deep:!0,handler(){3!==this.team1Loss&&3!==this.team2Loss||this.checkLossCondition(),this.syncState()}},team1Points(){this.checkGameEndCondition(),this.syncState()},team2Points(){this.checkGameEndCondition(),this.syncState()},question(){this.syncState()},currentQuestion(){this.syncState()},round(){this.syncState()},activeTeam(){this.syncState()},currentQuestionIndex(){this.syncState()},multiplierPoints(){this.syncState()}}});const rt=(0,c.A)(lt,[["render",A],["__scopeId","data-v-8a8871c4"]]);var ct=rt;const ut={class:"start-family-view"},dt={ref:"videoPlayer",class:"background-video",autoplay:"",loop:"",muted:"",playsinline:""},mt=["src"];function ht(e,t,s,a,i,n){const l=(0,o.g2)("StarterPanel"),r=(0,o.g2)("BuzzCompetition");return(0,o.uX)(),(0,o.CE)("div",ut,[(0,o.Lk)("video",dt,[(0,o.Lk)("source",{src:e.videoSrc,type:"video/mp4"},null,8,mt)],512),(0,o.bF)(l,{onGameStart:e.handleGameStart,onToggleBluetooth:e.toggleBluetooth,"is-connected":e.isConnected,"is-connecting":e.isConnecting,"bluetooth-error":e.bluetoothError},null,8,["onGameStart","onToggleBluetooth","is-connected","is-connecting","bluetooth-error"]),(0,o.bF)(r,{modelValue:e.showBuzz,"onUpdate:modelValue":t[0]||(t[0]=t=>e.showBuzz=t),team1Name:e.team1Name,team2Name:e.team2Name,"bluetooth-characteristic":e.bluetoothCharacteristic,showKeyboardHints:e.gameConfig?.showKeyboardHints,onTeamSelected:e.handleTeamSelected},null,8,["modelValue","team1Name","team2Name","bluetooth-characteristic","showKeyboardHints","onTeamSelected"])])}var pt=s(276),vt=s(7511),gt=s(8351),ft=s(1560),yt=s(7973),bt=s(2048);const wt={class:"checkboxes-container"},kt={key:0,class:"text-error mb-4 text-center"},Ct={class:"bluetooth-text"},Tt={key:1,class:"text-error mb-4 text-center"};function Lt(e,t,s,i,n,l){return(0,o.uX)(),(0,o.Wv)(fe.p,{modelValue:n.show,"onUpdate:modelValue":t[8]||(t[8]=e=>n.show=e),persistent:"",width:"600"},{default:(0,o.k6)((()=>[(0,o.bF)(T.J,{class:"text-center pa-4",style:{"background-color":"#000","background-image":"radial-gradient(#333 2px, transparent 3px)","background-size":"10px 10px"}},{default:(0,o.k6)((()=>[(0,o.bF)(_e.r,{class:"text-h4 mb-6",style:{color:"yellow","font-family":"'PixelFont'"}},{default:(0,o.k6)((()=>t[9]||(t[9]=[(0,o.eW)(" KONFIGURACJA GRY ")]))),_:1}),(0,o.bF)(K.O,{style:{"background-color":"#000","background-image":"none"}},{default:(0,o.k6)((()=>[(0,o.bF)(ft.n,{ref:"form",onSubmit:(0,a.D$)(l.startGame,["prevent"])},{default:(0,o.k6)((()=>[(0,o.bF)(bt.W,{modelValue:n.team1Name,"onUpdate:modelValue":t[0]||(t[0]=e=>n.team1Name=e),label:"Nazwa Drużyny 1",variant:"outlined",class:"mb-2",style:{color:"yellow"},rules:n.nameRules,"prepend-icon":"mdi-account-group",counter:10},null,8,["modelValue","rules"]),(0,o.bF)(bt.W,{modelValue:n.team2Name,"onUpdate:modelValue":t[1]||(t[1]=e=>n.team2Name=e),label:"Nazwa Drużyny 2",variant:"outlined",class:"mb-2",style:{color:"yellow"},rules:n.nameRules,"prepend-icon":"mdi-account-group",counter:10},null,8,["modelValue","rules"]),(0,o.bF)(gt.f,{modelValue:n.questionsFile,"onUpdate:modelValue":t[2]||(t[2]=e=>n.questionsFile=e),label:"Zestaw pytań",variant:"outlined",class:"mb-2",accept:".json",style:{color:"yellow"},rules:[e=>!!e||"Plik z pytaniami jest wymagany"],"prepend-icon":"mdi-file-question",onChange:l.handleFileChange},null,8,["modelValue","rules","onChange"]),(0,o.bF)(F.L,null,{default:(0,o.k6)((()=>[(0,o.bF)(_.B,{cols:"all"!==n.gameEndCondition?6:12},{default:(0,o.k6)((()=>[(0,o.bF)(yt.d4,{modelValue:n.gameEndCondition,"onUpdate:modelValue":t[3]||(t[3]=e=>n.gameEndCondition=e),items:n.gameEndConditions,label:"Warunek końca gry",variant:"outlined",class:"mb-2",style:{color:"yellow"},"prepend-icon":"mdi-flag-checkered","hide-details":""},null,8,["modelValue","items"])])),_:1},8,["cols"]),"all"!==n.gameEndCondition?((0,o.uX)(),(0,o.Wv)(_.B,{key:0,cols:"6"},{default:(0,o.k6)((()=>[(0,o.bF)(bt.W,{modelValue:n.gameEndLimit,"onUpdate:modelValue":t[4]||(t[4]=e=>n.gameEndLimit=e),modelModifiers:{number:!0},label:"points"===n.gameEndCondition?"Limit punktów":"Limit pytań",variant:"outlined",class:"mb-2",style:{color:"yellow"},type:"number",rules:n.limitRules,"prepend-icon":"mdi-numeric","hide-details":""},null,8,["modelValue","label","rules"])])),_:1})):(0,o.Q3)("",!0)])),_:1}),(0,o.Lk)("div",wt,[(0,o.bF)(pt.a,{modelValue:n.randomizeQuestions,"onUpdate:modelValue":t[5]||(t[5]=e=>n.randomizeQuestions=e),label:"Losowa kolejność pytań",color:"yellow","hide-details":"",density:"compact"},null,8,["modelValue"]),(0,o.bF)(pt.a,{modelValue:n.autoIncreaseMultiplier,"onUpdate:modelValue":t[6]||(t[6]=e=>n.autoIncreaseMultiplier=e),label:"Automatycznie zwiększaj mnożnik punktacji",color:"yellow","hide-details":"",density:"compact"},null,8,["modelValue"]),(0,o.bF)(pt.a,{modelValue:n.showKeyboardHints,"onUpdate:modelValue":t[7]||(t[7]=e=>n.showKeyboardHints=e),label:"Pokazuj wskazówki klawiszy",color:"yellow","hide-details":"",density:"compact"},null,8,["modelValue"])]),n.fileError?((0,o.uX)(),(0,o.CE)("div",kt,(0,E.v_)(n.fileError),1)):(0,o.Q3)("",!0),(0,o.bF)(vt.G,{class:"my-6"}),(0,o.bF)(h.D,{color:s.isConnected?"success":"primary",block:"",class:"mb-4 bluetooth-btn",onClick:l.toggleBluetooth,loading:s.isConnecting,disabled:s.isConnecting,elevation:"4",size:"large",height:"50"},{prepend:(0,o.k6)((()=>[(0,o.bF)(Se.w,{color:(s.isConnected,"white"),size:"large"},{default:(0,o.k6)((()=>[(0,o.eW)((0,E.v_)(s.isConnected?"mdi-bluetooth-connect":"mdi-bluetooth-off"),1)])),_:1},8,["color"])])),default:(0,o.k6)((()=>[(0,o.Lk)("span",Ct,(0,E.v_)(s.isConnected?"Odłącz kontroler buzzerów":"Podłącz kontroler buzzerów"),1)])),_:1},8,["color","onClick","loading","disabled"]),s.bluetoothError?((0,o.uX)(),(0,o.CE)("div",Tt,(0,E.v_)(s.bluetoothError),1)):(0,o.Q3)("",!0),(0,o.bF)(h.D,{color:"yellow",block:"",size:"x-large",height:"70",disabled:!l.isFormValid,onClick:l.startGame,class:"start-button mt-6",elevation:"8"},{prepend:(0,o.k6)((()=>[(0,o.bF)(Se.w,{color:"black",size:"large"},{default:(0,o.k6)((()=>t[10]||(t[10]=[(0,o.eW)("mdi-rocket-launch")]))),_:1})])),default:(0,o.k6)((()=>[t[11]||(t[11]=(0,o.Lk)("span",{class:"start-text"},"START!",-1))])),_:1},8,["disabled","onClick"])])),_:1},8,["onSubmit"])])),_:1})])),_:1})])),_:1},8,["modelValue"])}var Ft={name:"StarterPanel",setup(){const e=oe();return{audioManager:e}},props:{isConnected:{type:Boolean,default:!1},isConnecting:{type:Boolean,default:!1},bluetoothError:{type:String,default:null}},data(){return{show:!0,team1Name:"",team2Name:"",questionsFile:null,randomizeQuestions:!1,autoIncreaseMultiplier:!1,showKeyboardHints:!1,nameRules:[e=>!!e||"Nazwa drużyny jest wymagana",e=>e.length<=10||"Nazwa drużyny nie może być dłuższa niż 10 znaków"],fileError:null,gameEndCondition:"all",gameEndConditions:[{title:"Wszystkie pytania",value:"all"},{title:"Limit punktów",value:"points"},{title:"Limit pytań",value:"questions"}],gameEndLimit:null,limitRules:[e=>!!e||"Limit jest wymagany",e=>e>0||"Limit musi być większy od 0",e=>Number.isInteger(Number(e))||"Limit musi być liczbą całkowitą"]}},computed:{isFormValid(){const e=this.team1Name&&this.team2Name&&this.questionsFile&&this.team1Name.length<=10&&this.team2Name.length<=10;return"all"!==this.gameEndCondition?e&&this.gameEndLimit&&this.gameEndLimit>0&&Number.isInteger(Number(this.gameEndLimit)):e}},methods:{toggleBluetooth(){this.$emit("toggle-bluetooth")},async startGame(){const{valid:e}=await this.$refs.form.validate();if(e&&this.isFormValid)try{this.audioManager.stopAll();const e={team1Name:this.team1Name,team2Name:this.team2Name,questionsFile:this.questionsFile,randomizeQuestions:this.randomizeQuestions,autoIncreaseMultiplier:this.autoIncreaseMultiplier,isBluetoothConnected:this.isConnected,gameEndCondition:this.gameEndCondition,gameEndLimit:this.gameEndLimit,showKeyboardHints:this.showKeyboardHints};this.$emit("game-start",e),this.show=!1}catch(t){console.error("Błąd podczas startowania gry:",t),this.fileError="Wystąpił błąd podczas uruchamiania gry"}},async handleFileChange(e){const t=e.target.files[0];if(t)try{const e=await this.readFileContent(t),s=JSON.parse(e);if(!s.questions||!Array.isArray(s.questions))throw new Error("Nieprawidłowy format pliku - brak tablicy questions");s.questions.forEach(((e,t)=>{if(!e.question||!e.answers||!Array.isArray(e.answers))throw new Error(`Nieprawidłowa struktura pytania ${t+1}`);if(0===e.answers.length)throw new Error(`Pytanie ${t+1} nie ma żadnych odpowiedzi`);e.answers.forEach(((e,s)=>{if(!e.answer||"number"!==typeof e.points)throw new Error(`Nieprawidłowa struktura odpowiedzi ${s+1} w pytaniu ${t+1}`)}))})),this.questionsFile=t,this.fileError=null}catch(s){this.fileError=`Błąd walidacji pliku: ${s.message}`,e.target.value="",this.questionsFile=null}},readFileContent(e){return new Promise(((t,s)=>{const a=new FileReader;a.onload=e=>t(e.target.result),a.onerror=()=>s(new Error("Błąd odczytu pliku")),a.readAsText(e)}))}},beforeUnmount(){this.audioManager.stopAll()},watch:{gameEndCondition:{immediate:!0,handler(e){"points"===e?this.gameEndLimit=300:"questions"===e&&(this.gameEndLimit=7)}}}};const _t=(0,c.A)(Ft,[["render",Lt],["__scopeId","data-v-21f470c4"]]);var xt=_t,St=(0,o.pM)({name:"StartFamilyView",components:{StarterPanel:xt,BuzzCompetition:Fe},data(){return{videoSrc:nt,bluetoothDevice:null,bluetoothCharacteristic:null,isConnected:!1,showBuzz:!1,team1Name:"",team2Name:"",bluetoothError:null,isConnecting:!1,gameConfig:null}},setup(){const e=oe();return{audioManager:e}},methods:{async toggleBluetooth(){this.isConnected?await this.disconnectBluetooth():await this.connectToBluetooth()},async connectToBluetooth(){this.isConnecting=!0,this.bluetoothError=null;const e={filters:[{services:["0000ffe0-0000-1000-8000-00805f9b34fb"]}],optionalServices:["0000ffe0-0000-1000-8000-00805f9b34fb"]};try{this.bluetoothDevice=await navigator.bluetooth.requestDevice(e);const t=await this.bluetoothDevice.gatt.connect(),s=await t.getPrimaryService("0000ffe0-0000-1000-8000-00805f9b34fb");this.bluetoothCharacteristic=await s.getCharacteristic("0000ffe1-0000-1000-8000-00805f9b34fb"),await this.bluetoothCharacteristic.startNotifications(),this.bluetoothCharacteristic.addEventListener("characteristicvaluechanged",(e=>{const t=e.target.value.getUint8(0);49!==t&&50!==t||(this.showBuzz=!0,this.handleTeamSelected(49===t?1:2))})),this.isConnected=!0,this.bluetoothError=null,this.bluetoothDevice.addEventListener("gattserverdisconnected",(()=>{this.handleDisconnection()}))}catch(t){this.bluetoothError=this.getBluetoothErrorMessage(t),this.isConnected=!1}finally{this.isConnecting=!1}},getBluetoothErrorMessage(e){return"NotFoundError"===e.name?"Nie wybrano urządzenia. Spróbuj ponownie i wybierz HM-10.":"SecurityError"===e.name?"Brak uprawnień do Bluetooth. Sprawdź ustawienia przeglądarki.":"NotSupportedError"===e.name?"Twoja przeglądarka nie wspiera Web Bluetooth API.":`Błąd połączenia: ${e.message}`},handleDisconnection(){this.isConnected=!1,this.bluetoothDevice=null,this.bluetoothCharacteristic=null,this.bluetoothError="Urządzenie zostało rozłączone"},async disconnectBluetooth(){if(this.bluetoothCharacteristic)try{await this.bluetoothCharacteristic.stopNotifications()}catch(e){console.error("Error stopping notifications",e)}this.bluetoothDevice&&this.bluetoothDevice.gatt.connected&&await this.bluetoothDevice.gatt.disconnect(),this.handleDisconnection()},async handleGameStart(e){if(console.log("Otrzymana konfiguracja:",e),!e.questionsFile)return console.error("Brak pliku z pytaniami"),void alert("Brak pliku z pytaniami");try{this.audioManager.stopAll();const s=new FileReader,a=await new Promise(((t,a)=>{s.onload=e=>{console.log("Plik wczytany pomyślnie"),t(e.target.result)},s.onerror=()=>{console.error("Błąd podczas czytania pliku"),a(new Error("Błąd odczytu pliku"))},s.readAsText(e.questionsFile)})),o=JSON.parse(a);if(!o.questions||!Array.isArray(o.questions))throw new Error("Nieprawidłowy format pliku z pytaniami");e.randomizeQuestions&&(o.questions=this.shuffleArray([...o.questions]));const i={team1Name:e.team1Name,team2Name:e.team2Name,questionsData:o.questions,randomizeQuestions:e.randomizeQuestions,autoIncreaseMultiplier:e.autoIncreaseMultiplier,isBluetoothConnected:this.isConnected,gameEndCondition:e.gameEndCondition,gameEndLimit:e.gameEndLimit,showKeyboardHints:e.showKeyboardHints};localStorage.setItem("familyGameConfig",JSON.stringify(i)),this.bluetoothDevice&&(window.bluetoothState={device:this.bluetoothDevice,characteristic:this.bluetoothCharacteristic,isConnected:this.isConnected,server:this.bluetoothDevice?.gatt},this.bluetoothDevice.removeEventListener("gattserverdisconnected",this.handleDisconnection));try{await this.$router.replace("/family")}catch(t){console.error("Błąd nawigacji:",t),window.location.href="/family"}}catch(s){console.error("Szczegółowy błąd:",s),alert(`Błąd podczas uruchamiania gry: ${s.message}`)}},handleTeamSelected(e){1===e?this.team1Name="Drużyna 1":2===e&&(this.team2Name="Drużyna 2"),setTimeout((()=>{this.showBuzz=!1}),3e3)},shuffleArray(e){for(let t=e.length-1;t>0;t--){const s=Math.floor(Math.random()*(t+1));[e[t],e[s]]=[e[s],e[t]]}return e}},beforeUnmount(){this.audioManager.stopAll(),"/family"!==this.$router.currentRoute.value.path&&this.disconnectBluetooth()},mounted(){this.audioManager.playIntro()}});const zt=(0,c.A)(St,[["render",ht],["__scopeId","data-v-6d962ffa"]]);var Pt=zt;const Nt={class:"host-panel-view"},At={class:"round-badge"},Et={class:"team-name"},It={class:"question-display"},Rt={class:"question-text"},Bt={class:"answers-container"},Vt={class:"answer-number"},Dt={class:"answer-text"},Wt={class:"answer-points"},qt={class:"controls-container"};function Kt(e,t,s,a,i,n){return(0,o.uX)(),(0,o.CE)("div",Nt,[(0,o.Lk)("div",At," Runda "+(0,E.v_)(e.round),1),e.activeTeam?((0,o.uX)(),(0,o.CE)("div",{key:0,class:(0,E.C4)(["active-team-badge",`team-${e.activeTeam}`])},[(0,o.Lk)("div",{class:(0,E.C4)(["team-color-indicator",`team-${e.activeTeam}`])},null,2),(0,o.Lk)("div",Et,(0,E.v_)(e.activeTeamName),1)],2)):(0,o.Q3)("",!0),(0,o.bF)(L.I,{fluid:"",class:"host-container"},{default:(0,o.k6)((()=>[(0,o.bF)(F.L,{class:"question-row","no-gutters":""},{default:(0,o.k6)((()=>[(0,o.bF)(_.B,{cols:"12"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",It,[(0,o.Lk)("h2",Rt,(0,E.v_)(e.currentQuestion||"Brak pytania"),1)])])),_:1})])),_:1}),(0,o.Lk)("div",Bt,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.answerColumns,((t,s)=>((0,o.uX)(),(0,o.CE)("div",{key:`col-${s}`,class:"answer-column"},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t,(t=>((0,o.uX)(),(0,o.Wv)(T.J,{key:`answer-${t.id}`,class:(0,E.C4)(["answer-card",{"answer-selected":t.pass,"answer-available":!t.pass}]),onClick:s=>e.selectAnswer(t.id),disabled:t.pass,elevation:"4"},{default:(0,o.k6)((()=>[(0,o.bF)(K.O,{class:"answer-content"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",Vt,(0,E.v_)(t.id),1),(0,o.Lk)("div",Dt,(0,E.v_)(t.name||"..."),1),(0,o.Lk)("div",Wt,(0,E.v_)(t.points)+" pkt",1)])),_:2},1024)])),_:2},1032,["class","onClick","disabled"])))),128))])))),128))]),(0,o.Lk)("div",qt,[(0,o.bF)(h.D,{color:"green",size:"large",class:"control-button",onClick:t[0]||(t[0]=t=>e.handleAction("swap"))},{default:(0,o.k6)((()=>[(0,o.bF)(Se.w,{left:""},{default:(0,o.k6)((()=>t[3]||(t[3]=[(0,o.eW)("mdi-swap-horizontal")]))),_:1}),t[4]||(t[4]=(0,o.eW)(" Zmiana drużyny "))])),_:1}),(0,o.bF)(h.D,{color:"orange",size:"large",class:"control-button",onClick:t[1]||(t[1]=t=>e.handleAction("timer"))},{default:(0,o.k6)((()=>[(0,o.bF)(Se.w,{left:""},{default:(0,o.k6)((()=>t[5]||(t[5]=[(0,o.eW)("mdi-timer")]))),_:1}),t[6]||(t[6]=(0,o.eW)(" Timer "))])),_:1}),(0,o.bF)(h.D,{color:"yellow",size:"large",class:"control-button",onClick:t[2]||(t[2]=t=>e.handleAction("points"))},{default:(0,o.k6)((()=>[(0,o.bF)(Se.w,{left:""},{default:(0,o.k6)((()=>t[7]||(t[7]=[(0,o.eW)("mdi-numeric")]))),_:1}),(0,o.eW)(" Punkty (x"+(0,E.v_)(e.multiplierPoints)+") ",1)])),_:1}),(0,o.bF)(h.D,{color:"blue",size:"large",class:"control-button undo-loss-button",onClick:e.handleUndoLoss,disabled:!e.canUndoLoss},{default:(0,o.k6)((()=>[(0,o.bF)(Se.w,{left:""},{default:(0,o.k6)((()=>t[8]||(t[8]=[(0,o.eW)("mdi-undo")]))),_:1}),t[9]||(t[9]=(0,o.eW)(" Cofnij utratę "))])),_:1},8,["onClick","disabled"]),(0,o.bF)(h.D,{color:"red",size:"large",class:"control-button loss-button",onClick:e.handleLoss,disabled:!e.activeTeam},{default:(0,o.k6)((()=>[(0,o.bF)(Se.w,{left:""},{default:(0,o.k6)((()=>t[10]||(t[10]=[(0,o.eW)("mdi-close-circle")]))),_:1}),t[11]||(t[11]=(0,o.eW)(" UTRATA "))])),_:1},8,["onClick","disabled"])])])),_:1})])}var jt=(0,o.pM)({name:"HostPanelView",data(){return{currentQuestion:"",answers:[],round:1,currentPoints:0,activeTeam:null,gameConfig:null,questionsData:null,currentQuestionIndex:0,multiplierPoints:1,channel:null,team1Loss:0,team2Loss:0,team1Name:"",team2Name:""}},computed:{answerColumns(){if(!this.answers||0===this.answers.length)return[];const e=[];for(let t=0;t<this.answers.length;t+=2)e.push(this.answers.slice(t,t+2));return e},calculatedPoints(){const e=this.answers.filter((e=>e.pass)).reduce(((e,t)=>e+t.points),0);return e*this.multiplierPoints},canUndoLoss(){return!!this.activeTeam&&(1===this.activeTeam?this.team1Loss>0:2===this.activeTeam&&this.team2Loss>0)},activeTeamName(){return 1===this.activeTeam?this.team1Name||"Drużyna 1":2===this.activeTeam?this.team2Name||"Drużyna 2":""}},created(){const e=localStorage.getItem("familyGameConfig");if(e){try{const t=JSON.parse(e);this.gameConfig=t,this.questionsData={questions:t.questionsData},t.team1Name&&(this.team1Name=t.team1Name),t.team2Name&&(this.team2Name=t.team2Name)}catch(t){return void this.$router.push("/start-family")}this.channel=new BroadcastChannel("family-game-sync"),this.channel.onmessage=e=>{this.handleStateUpdate(e.data)},this.loadInitialState()}else this.$router.push("/start-family")},beforeUnmount(){this.channel&&this.channel.close()},methods:{loadInitialState(){const e=localStorage.getItem("familyGameState");if(e)try{const t=JSON.parse(e);void 0!==t.currentQuestionIndex&&(this.currentQuestionIndex=t.currentQuestionIndex,this.loadAnswersFromQuestionData()),this.updateState(t)}catch(t){console.error("Błąd podczas ładowania stanu:",t)}},handleStateUpdate(e){"state-update"===e.type&&this.updateState(e.state)},updateState(e){const t=this.currentQuestionIndex;void 0!==e.currentQuestionIndex&&(this.currentQuestionIndex=e.currentQuestionIndex),void 0!==e.currentQuestion&&(this.currentQuestion=e.currentQuestion),void 0!==e.question&&(this.currentQuestion=e.question),void 0!==e.currentQuestionIndex&&e.currentQuestionIndex!==t&&this.loadAnswersFromQuestionData(),this.currentQuestion&&0!==this.answers.length||void 0===this.currentQuestionIndex||this.loadAnswersFromQuestionData(),void 0!==e.results&&e.results.length>0&&(this.answers.length>0?this.answers=this.answers.map((t=>{const s=e.results.find((e=>e.id===t.id));return s?{...t,name:s.name||t.name||"",points:s.points||t.points||0,pass:s.pass||!1}:t})):this.answers=e.results.map((e=>({id:e.id,name:e.name||"",points:e.points||0,pass:e.pass||!1})))),void 0!==e.round&&(this.round=e.round),void 0!==e.currentPoints&&(this.currentPoints=e.currentPoints),void 0!==e.activeTeam&&(this.activeTeam=e.activeTeam),void 0!==e.multiplierPoints&&(this.multiplierPoints=e.multiplierPoints),void 0!==e.team1Loss&&(this.team1Loss=e.team1Loss),void 0!==e.team2Loss&&(this.team2Loss=e.team2Loss),void 0!==e.team1Name&&(this.team1Name=e.team1Name),void 0!==e.team2Name&&(this.team2Name=e.team2Name)},loadAnswersFromQuestionData(){if(this.questionsData&&this.questionsData.questions&&this.questionsData.questions[this.currentQuestionIndex]){const e=this.questionsData.questions[this.currentQuestionIndex];e.question&&(this.currentQuestion=e.question),e.answers&&Array.isArray(e.answers)&&(this.answers=e.answers.map(((e,t)=>({id:t+1,name:e.answer||"",points:e.points||0,pass:!1}))))}},selectAnswer(e){this.channel&&this.channel.postMessage({type:"action",action:`show-answer-${e}`})},handleLoss(){this.activeTeam&&this.handleAction("loss")},handleUndoLoss(){this.canUndoLoss&&this.handleAction("undo-loss")},handleAction(e){this.channel&&this.channel.postMessage({type:"action",action:e})}}});const Ot=(0,c.A)(jt,[["render",Kt],["__scopeId","data-v-6ba83702"]]);var Mt=Ot;const $t={class:"board-container"};function Qt(e,t,s,a,i,n){const l=(0,o.g2)("VotingTopic"),r=(0,o.g2)("VotingResult"),c=(0,o.g2)("IndividualResult"),u=(0,o.g2)("StatusPanel");return(0,o.uX)(),(0,o.CE)("div",$t,[t[4]||(t[4]=(0,o.Lk)("div",{class:"background-image"},null,-1)),(0,o.Lk)("div",{class:"content-wrapper",style:(0,E.Tr)({opacity:a.contentOpacity})},[(0,o.bF)(l,{"session-id":s.sessionId},null,8,["session-id"]),"Podsumowanie"!==a.gameStage?((0,o.uX)(),(0,o.Wv)(r,{key:0,"voting-number":a.currentTopicNumber,"votes-for":a.votesFor,"votes-against":a.votesAgainst,"votes-abstain":a.votesAbstain,"show-collective":"Wyniki"===a.gameStage,"collective-votes":a.collectiveVotes},null,8,["voting-number","votes-for","votes-against","votes-abstain","show-collective","collective-votes"])):"Podsumowanie"===a.gameStage?((0,o.uX)(),(0,o.Wv)(c,{key:1,votes:a.votes},null,8,["votes"])):(0,o.Q3)("",!0),(0,o.bF)(u,{onStageChanged:a.handleStageChange,"session-id":s.sessionId},null,8,["onStageChanged","session-id"])],4),(0,o.bF)(fe.p,{modelValue:a.showEndGameDialog,"onUpdate:modelValue":t[0]||(t[0]=e=>a.showEndGameDialog=e),persistent:"","max-width":"400"},{default:(0,o.k6)((()=>[(0,o.bF)(T.J,null,{default:(0,o.k6)((()=>[(0,o.bF)(_e.r,{class:"text-h5 text-center pa-4"},{default:(0,o.k6)((()=>t[1]||(t[1]=[(0,o.eW)(" Koniec głosowań ")]))),_:1}),(0,o.bF)(K.O,{class:"text-center pa-4"},{default:(0,o.k6)((()=>t[2]||(t[2]=[(0,o.eW)(" Wyczerpano wszystkie tematy do głosowania. ")]))),_:1}),(0,o.bF)(xe.S,{class:"justify-center pa-4"},{default:(0,o.k6)((()=>[(0,o.bF)(h.D,{color:"primary",onClick:a.goToStart,size:"large"},{default:(0,o.k6)((()=>t[3]||(t[3]=[(0,o.eW)(" OK ")]))),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])}function Zt(e,t,s,a,i,n){return(0,o.uX)(),(0,o.Wv)(L.I,{class:"fill-height"},{default:(0,o.k6)((()=>[(0,o.bF)(F.L,{justify:"center",align:"center"},{default:(0,o.k6)((()=>[(0,o.bF)(_.B,{cols:"12",sm:"10",md:"8"},{default:(0,o.k6)((()=>[(0,o.bF)(T.J,{class:"text-center pa-6",elevation:"8"},{default:(0,o.k6)((()=>[(0,o.bF)(_e.r,{class:"voting-header mb-6"},{default:(0,o.k6)((()=>[(0,o.eW)(" GŁOSOWANIE NR "+(0,E.v_)(a.actNumber),1)])),_:1}),(0,o.bF)(K.O,{class:"voting-question"},{default:(0,o.k6)((()=>[(0,o.eW)((0,E.v_)(a.actQuestion),1)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}var Gt=s(6400),Xt=s(3220);const Ut={apiKey:"AIzaSyCyt6X6-s2SXp_XWkIbHxEdCGhDFJt4sF4",authDomain:"mirsan-quiz.firebaseapp.com",databaseURL:"https://mirsan-quiz-default-rtdb.europe-west1.firebasedatabase.app",projectId:"mirsan-quiz",storageBucket:"mirsan-quiz.firebasestorage.app",messagingSenderId:"581748605996",appId:"1:581748605996:web:a37b5bab589dc38d3c3d89",measurementId:"G-KRL965KSBS"},Ht=(0,Gt.Wp)(Ut),Jt=(0,Xt.C3)(Ht);var Yt=s(3649);const es=(0,ke.KR)([]);console.log("Initializing topics.js module");const ts=e=>{if(console.log("Extracting topics from:",e),Array.isArray(e))return console.log("Data is an array"),e;if(e&&"object"===typeof e){if(console.log("Data is an object"),e.topics&&Array.isArray(e.topics))return console.log("Found topics array in data object"),e.topics;const t=Object.values(e);if(t.length>0&&t.every((e=>"string"===typeof e)))return console.log("Found array-like object with string values"),t}return console.warn("Unexpected data structure:",e),[]},ss=()=>{console.log("useTopics hook called");const e=async()=>{console.log("loadTopics called");try{const e=(0,Xt.KR)(Jt,"topics"),t=await(0,Xt.Jt)(e);if(console.log("Raw Firebase response:",t.val()),!t.exists())return console.log("No topics found in Firebase"),es.value=[],[];const s=ts(t.val());return console.log("Extracted topics:",s),console.log("Setting topicsState.value to:",s),es.value=[...s],s}catch(e){return console.error("Error loading topics:",e),es.value=[],[]}},t=async e=>{console.log("saveTopics called with:",e);try{const t=(0,Xt.KR)(Jt,"topics");await(0,Xt.hZ)(t,{topics:e}),console.log("Setting topicsState.value in saveTopics to:",e),es.value=[...e],console.log("Topics saved successfully")}catch(t){console.error("Error saving topics:",t)}},s=()=>{console.log("setupTopicsListener called");const e=(0,Xt.KR)(Jt,"topics");(0,Xt.Zy)(e,(e=>{const t=e.val();console.log("Topics updated in Firebase:",t);const s=ts(t);console.log("Setting topicsState.value in listener to:",s),es.value=[...s]}))};return{topics:es,loadTopics:e,saveTopics:t,setupTopicsListener:s}},as=async()=>{console.log("initializeDefaultTopics called");try{const e=(0,Xt.KR)(Jt,"topics"),t=await(0,Xt.Jt)(e);if(t.exists()){const e=ts(t.val());console.log("Setting topicsState.value in initializeDefaultTopics (existing) to:",e),es.value=[...e]}else{console.log("No topics found, initializing default topics...");const t=["Zalegalizowanie marihuany","Dopuszczalność aborcji","Eutanazja i prawo do śmierci","Małżeństwa osób tej samej płci","Kary cielesne wobec dzieci","Kara śmierci","Obowiązkowe szczepienia","Ograniczenie wolności słowa w imię walki z mową nienawiści"];await(0,Xt.hZ)(e,{topics:t}),console.log("Setting topicsState.value in initializeDefaultTopics to:",t),es.value=[...t],console.log("Default topics initialized")}}catch(e){console.error("Error initializing default topics:",e)}};var os={name:"VotingTopic",props:{sessionId:{type:String,required:!0}},setup(e){const t=(0,ke.KR)(1),s=(0,ke.KR)(null),{topics:a}=ss(),i=(0,o.EW)((()=>null!==s.value&&a.value?a.value[s.value]||"Brak tematu":"Ładowanie tematu..."));return(0,o.sV)((()=>{const a=(0,Yt.KR)(Jt,`sessions/${e.sessionId}/currentTopic`);(0,Yt.Zy)(a,(e=>{const a=e.val();a?(s.value=a.id,t.value=a.number||s.value+1):(s.value=0,t.value=1)}))})),{actNumber:t,actQuestion:i}}};const is=(0,c.A)(os,[["render",Zt],["__scopeId","data-v-668e88ba"]]);var ns=is,ls=s(9336);const rs={class:"d-flex justify-space-between align-center"},cs={class:"voting-value"},us={class:"d-flex justify-space-between align-center"},ds={class:"voting-value"},ms={class:"progress-text"},hs={class:"d-flex justify-space-between align-center"},ps={class:"voting-value"},vs={class:"progress-text"},gs={class:"d-flex justify-space-between align-center"},fs={class:"voting-value"},ys={class:"progress-text"};function bs(e,t,s,a,i,n){return(0,o.uX)(),(0,o.Wv)(T.J,{class:"mx-auto my-4 voting-card","max-width":"800",elevation:"8"},{default:(0,o.k6)((()=>[(0,o.bF)(K.O,{class:"voting-results pa-4"},{default:(0,o.k6)((()=>[(0,o.bF)(F.L,{class:"text-h5 mb-2"},{default:(0,o.k6)((()=>[(0,o.bF)(_.B,{cols:"12"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",rs,[t[3]||(t[3]=(0,o.Lk)("span",{class:"voting-label"},"GŁOSOWAŁO",-1)),(0,o.Lk)("span",cs,(0,E.v_)(a.totalVotes),1)])])),_:1})])),_:1}),(0,o.bF)(F.L,{class:"text-h5 mb-2"},{default:(0,o.k6)((()=>[(0,o.bF)(_.B,{cols:"12"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",us,[t[4]||(t[4]=(0,o.Lk)("span",{class:"voting-label"},"ZA",-1)),(0,o.Lk)("span",ds,(0,E.v_)(a.currentVotesFor),1)]),(0,o.bF)(ls.Z,{modelValue:a.animatedForPercentage,"onUpdate:modelValue":t[0]||(t[0]=e=>a.animatedForPercentage=e),color:"success",height:"40",rounded:"",class:"mt-1 progress-bar"},{default:(0,o.k6)((({value:e})=>[(0,o.Lk)("span",ms,(0,E.v_)(Math.ceil(e))+"%",1)])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,o.bF)(F.L,{class:"text-h5 mb-2"},{default:(0,o.k6)((()=>[(0,o.bF)(_.B,{cols:"12"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",hs,[t[5]||(t[5]=(0,o.Lk)("span",{class:"voting-label"},"PRZECIW",-1)),(0,o.Lk)("span",ps,(0,E.v_)(a.currentVotesAgainst),1)]),(0,o.bF)(ls.Z,{modelValue:a.animatedAgainstPercentage,"onUpdate:modelValue":t[1]||(t[1]=e=>a.animatedAgainstPercentage=e),color:"error",height:"40",rounded:"",class:"mt-1 progress-bar"},{default:(0,o.k6)((({value:e})=>[(0,o.Lk)("span",vs,(0,E.v_)(Math.ceil(e))+"%",1)])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,o.bF)(F.L,{class:"text-h5"},{default:(0,o.k6)((()=>[(0,o.bF)(_.B,{cols:"12"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",gs,[t[6]||(t[6]=(0,o.Lk)("span",{class:"voting-label"},"WSTRZYMANO SIĘ",-1)),(0,o.Lk)("span",fs,(0,E.v_)(a.currentVotesAbstain),1)]),(0,o.bF)(ls.Z,{modelValue:a.animatedAbstainPercentage,"onUpdate:modelValue":t[2]||(t[2]=e=>a.animatedAbstainPercentage=e),color:"warning",height:"40",rounded:"",class:"mt-1 progress-bar"},{default:(0,o.k6)((({value:e})=>[(0,o.Lk)("span",ys,(0,E.v_)(Math.ceil(e))+"%",1)])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1})}var ws={name:"VotingResult",props:{votingNumber:{type:Number,required:!0},votesFor:{type:Number,required:!0},votesAgainst:{type:Number,required:!0},votesAbstain:{type:Number,required:!0},showCollective:{type:Boolean,default:!1},collectiveVotes:{type:Object,default:null}},setup(e){const t=(0,ke.KR)(0),s=(0,ke.KR)(0),a=(0,ke.KR)(0),i=(0,ke.KR)(!1);(0,o.wB)((()=>e.showCollective),(e=>{e?setTimeout((()=>{i.value=!0}),500):i.value=!1}));const n=(0,o.EW)((()=>e.showCollective&&e.collectiveVotes?Object.values(e.collectiveVotes).reduce(((e,t)=>e+t),0):e.votesFor+e.votesAgainst+e.votesAbstain)),l=(0,o.EW)((()=>e.showCollective&&e.collectiveVotes?e.collectiveVotes.ZA||0:e.votesFor)),r=(0,o.EW)((()=>e.showCollective&&e.collectiveVotes?e.collectiveVotes.PRZECIW||0:e.votesAgainst)),c=(0,o.EW)((()=>e.showCollective&&e.collectiveVotes?e.collectiveVotes["WSTRZYMANO SIĘ"]||0:e.votesAbstain)),u=(0,o.EW)((()=>n.value?l.value/n.value*100:0)),d=(0,o.EW)((()=>n.value?r.value/n.value*100:0)),m=(0,o.EW)((()=>n.value?c.value/n.value*100:0));(0,o.wB)([()=>e.votesFor,()=>e.collectiveVotes],(()=>{h(t,u.value)}),{deep:!0}),(0,o.wB)([()=>e.votesAgainst,()=>e.collectiveVotes],(()=>{h(s,d.value)}),{deep:!0}),(0,o.wB)([()=>e.votesAbstain,()=>e.collectiveVotes],(()=>{h(a,m.value)}),{deep:!0});const h=(e,t)=>{const s=1e3,a=e.value,o=Date.now(),i=()=>{const n=Date.now(),l=n-o;l<s?(e.value=a+(t-a)*l/s,requestAnimationFrame(i)):e.value=t};requestAnimationFrame(i)};return{totalVotes:n,currentVotesFor:l,currentVotesAgainst:r,currentVotesAbstain:c,animatedForPercentage:t,animatedAgainstPercentage:s,animatedAbstainPercentage:a,showCollectiveResults:i}}};const ks=(0,c.A)(ws,[["render",bs],["__scopeId","data-v-0fd051d4"]]);var Cs=ks,Ts=s(3260);const Ls={class:"table-container"},Fs={class:"text-center"},_s={class:"text-center"};function xs(e,t,s,a,i,n){return(0,o.uX)(),(0,o.Wv)(T.J,{class:"mx-auto my-4 voting-card","max-width":"800",elevation:"8"},{default:(0,o.k6)((()=>[(0,o.bF)(_e.r,{class:"text-h4 text-center pa-4 voting-title"},{default:(0,o.k6)((()=>t[0]||(t[0]=[(0,o.eW)(" WYNIKI INDYWIDUALNE GŁOSOWANIA ")]))),_:1}),(0,o.bF)(K.O,{class:"voting-results"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",Ls,[(0,o.bF)(Ts.Z,null,{default:(0,o.k6)((()=>[t[1]||(t[1]=(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("th",{class:"text-center",style:{width:"80px"}},"Lp."),(0,o.Lk)("th",{class:"text-center"},"Poseł"),(0,o.Lk)("th",{class:"text-center"},"Głosowanie")])],-1)),(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.sortedDeputies,((e,t)=>((0,o.uX)(),(0,o.CE)("tr",{key:e.name},[(0,o.Lk)("td",Fs,(0,E.v_)(t+1),1),(0,o.Lk)("td",null,(0,E.v_)(n.formatName(e.name)),1),(0,o.Lk)("td",_s,[(0,o.bF)(I.x,{color:n.getVoteColor(e.vote),text:n.getVoteText(e.vote),class:"font-weight-bold text-center",variant:"elevated"},null,8,["color","text"])])])))),128))])])),_:1})])])),_:1})])),_:1})}var Ss={name:"IndividualResult",props:{votes:{type:Object,required:!0}},computed:{sortedDeputies(){return Object.entries(this.votes).map((([e,t])=>({name:e,vote:t.option}))).sort(((e,t)=>{const s=this.formatName(e.name).toLowerCase(),a=this.formatName(t.name).toLowerCase();return s.localeCompare(a)}))}},methods:{formatName(e){const t=e.split(" ");if(1===t.length)return e;const s=t[t.length-1],a=t.slice(0,-1).join(" ");return`${s} ${a}`},getVoteColor(e){switch(e){case"ZA":return"success";case"PRZECIW":return"error";case"WSTRZYMANO SIĘ":return"warning";default:return"grey"}},getVoteText(e){return e||"Nie głosowano"}}};const zs=(0,c.A)(Ss,[["render",xs],["__scopeId","data-v-30c13843"]]);var Ps=zs;const Ns={class:"d-flex align-center justify-space-between"},As={class:"status-content text-h4"},Es={key:0},Is={class:"stage-name"},Rs={key:1},Bs={class:"stage-shortcut text-caption"};function Vs(e,t,s,a,i,n){return(0,o.uX)(),(0,o.Wv)(L.I,null,{default:(0,o.k6)((()=>[(0,o.bF)(F.L,{justify:"center",align:"center"},{default:(0,o.k6)((()=>[(0,o.bF)(_.B,{cols:"12",sm:"10",md:"8"},{default:(0,o.k6)((()=>[(0,o.bF)(T.J,{class:"status-panel pa-4",elevation:"4",width:"800"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",Ns,[(0,o.bF)(h.D,{variant:"text",class:"custom-btn",onClick:n.previousStage,disabled:0===i.currentStageIndex},{default:(0,o.k6)((()=>[t[1]||(t[1]=(0,o.Lk)("span",{class:"text-h4"},"-",-1)),(0,o.bF)(ye.y,{activator:"parent",location:"top"},{default:(0,o.k6)((()=>t[0]||(t[0]=[(0,o.Lk)("span",null,"Poprzedni etap (-)",-1)]))),_:1})])),_:1},8,["onClick","disabled"]),(0,o.Lk)("div",As,[3===i.currentStageIndex&&i.showVotingResult?((0,o.uX)(),(0,o.CE)("span",Rs,[(0,o.Lk)("span",{class:(0,E.C4)(["stage-name",{passed:n.isPassed,rejected:!n.isPassed}])},(0,E.v_)(n.displayStage),3)])):((0,o.uX)(),(0,o.CE)("span",Es,[t[2]||(t[2]=(0,o.eW)(" Etap: ")),(0,o.Lk)("span",Is,(0,E.v_)(n.currentStage),1)])),(0,o.Lk)("div",Bs," ("+(0,E.v_)(i.currentStageIndex+1)+") ",1)]),i.currentStageIndex===i.stages.length-1?((0,o.uX)(),(0,o.Wv)(h.D,{key:0,variant:"text",class:"custom-btn",onClick:n.nextStage,disabled:i.currentStageIndex!==i.stages.length-1},{default:(0,o.k6)((()=>[t[4]||(t[4]=(0,o.Lk)("span",{class:"text-h6"},"Dalej",-1)),(0,o.bF)(ye.y,{activator:"parent",location:"top"},{default:(0,o.k6)((()=>t[3]||(t[3]=[(0,o.Lk)("span",null,"Przejdź dalej (Enter)",-1)]))),_:1})])),_:1},8,["onClick","disabled"])):((0,o.uX)(),(0,o.Wv)(h.D,{key:1,variant:"text",class:"custom-btn",onClick:n.nextStage,disabled:i.currentStageIndex===i.stages.length-1},{default:(0,o.k6)((()=>[t[6]||(t[6]=(0,o.Lk)("span",{class:"text-h4"},"+",-1)),(0,o.bF)(ye.y,{activator:"parent",location:"top"},{default:(0,o.k6)((()=>t[5]||(t[5]=[(0,o.Lk)("span",null,"Następny etap (+)",-1)]))),_:1})])),_:1},8,["onClick","disabled"]))])])),_:1})])),_:1})])),_:1})])),_:1})}var Ds={name:"StatusPanel",components:{},setup(){const e=oe();return{audioManager:e}},props:{sessionId:{type:String,required:!0}},data(){return{stages:["Pierwsze czytanie","Drugie czytanie","Głosowanie","Wyniki","Podsumowanie"],currentStageIndex:0,currentTopicNumber:1,totalTopics:0,votesFor:0,votesAgainst:0,votesAbstain:0,showVotingResult:!1,votingResultTimer:null,confettiAnimationId:null,myConfetti:null,isAnimating:!1}},computed:{currentStage(){return this.stages[this.currentStageIndex]},displayStage(){return 3===this.currentStageIndex?this.isPassed?"PRZEGŁOSOWANO":"ODRZUCONO":this.currentStage},isPassed(){const e=this.votesFor+this.votesAgainst+this.votesAbstain;return 0!==e&&this.votesFor/e>.5}},methods:{nextStage(){this.currentStageIndex<this.stages.length-1?(this.currentStageIndex++,this.$emit("stage-changed",this.currentStage),this.votingResultTimer&&(clearTimeout(this.votingResultTimer),this.votingResultTimer=null),this.showVotingResult=!1,this.stopConfetti(),3===this.currentStageIndex&&(this.votingResultTimer=setTimeout((()=>{this.showVotingResult=!0,this.audioManager.playClapping(),this.isPassed&&this.fireConfetti()}),2e3))):this.currentStageIndex===this.stages.length-1&&this.goToNextTopic()},async goToNextTopic(){if(this.currentTopicNumber>=this.totalTopics)return;this.currentTopicNumber++,this.currentStageIndex=0,this.votingResultTimer&&(clearTimeout(this.votingResultTimer),this.votingResultTimer=null),this.showVotingResult=!1;const e=(0,Yt.KR)(Jt,`sessions/${this.sessionId}/currentTopic`);await(0,Yt.hZ)(e,{id:this.currentTopicNumber-1,number:this.currentTopicNumber});const t=(0,Yt.KR)(Jt,`sessions/${this.sessionId}/votes`);await(0,Yt.hZ)(t,null),this.$emit("stage-changed",this.currentStage)},previousStage(){this.currentStageIndex>0&&(this.currentStageIndex--,this.$emit("stage-changed",this.currentStage),this.votingResultTimer&&(clearTimeout(this.votingResultTimer),this.votingResultTimer=null),this.showVotingResult=!1)},goToStage(e){e>=0&&e<this.stages.length&&(this.currentStageIndex=e,this.$emit("stage-changed",this.currentStage),this.votingResultTimer&&(clearTimeout(this.votingResultTimer),this.votingResultTimer=null),this.showVotingResult=!1,3===this.currentStageIndex&&(this.votingResultTimer=setTimeout((()=>{this.showVotingResult=!0}),2e3)))},handleKeydown(e){switch(e.key){case"+":case"ArrowRight":this.currentStageIndex!==this.stages.length-1&&this.nextStage();break;case"-":case"ArrowLeft":this.previousStage();break;case"Enter":this.currentStageIndex===this.stages.length-1&&this.goToNextTopic();break;case"1":case"2":case"3":case"4":case"5":this.goToStage(parseInt(e.key)-1);break}},updateVoteCounts(){const e=(0,Yt.KR)(Jt,`sessions/${this.sessionId}/votes`);(0,Yt.Zy)(e,(e=>{if(e.exists()){const t=e.val();this.votesFor=0,this.votesAgainst=0,this.votesAbstain=0,Object.values(t).forEach((e=>{"ZA"===e.option?this.votesFor++:"PRZECIW"===e.option?this.votesAgainst++:"WSTRZYMANO SIĘ"===e.option&&this.votesAbstain++}))}else this.votesFor=0,this.votesAgainst=0,this.votesAbstain=0}))},fireConfetti(){if(this.isAnimating)return;this.isAnimating=!0;const e=document.createElement("canvas");e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.height="100%",e.style.pointerEvents="none",e.style.zIndex="100000",document.body.appendChild(e),this.myConfetti=st.A.create(e,{resize:!0,useWorker:!0});const t=8e3,s=Date.now()+t,a=["#ff0000","#ffffff"],o=()=>{if(!this.isAnimating)return;const e=s-Date.now(),i=e/t,n=Math.floor(7*i),l=55+20*(1-i),r=.8+.4*(1-i);this.myConfetti({particleCount:n,angle:60,spread:l,origin:{x:0},colors:a,gravity:r,scalar:1.5,ticks:300,zIndex:1e5,decay:.95}),this.myConfetti({particleCount:n,angle:120,spread:l,origin:{x:1},colors:a,gravity:r,scalar:1.5,ticks:300,zIndex:1e5,decay:.95}),e>0?this.confettiAnimationId=requestAnimationFrame(o):(this.myConfetti({particleCount:20,spread:100,decay:.9,scalar:.8,origin:{y:.6},colors:a}),setTimeout((()=>{this.stopConfetti()}),1e3))};o()},stopConfetti(){this.isAnimating=!1,setTimeout((()=>{this.myConfetti&&(this.myConfetti.reset(),this.myConfetti=null),this.confettiAnimationId&&(cancelAnimationFrame(this.confettiAnimationId),this.confettiAnimationId=null);const e=document.querySelectorAll("canvas");e.forEach((e=>{e.style.transition="opacity 0.5s",e.style.opacity="0",setTimeout((()=>e.remove()),500)}))}),1e3)}},mounted(){window.addEventListener("keydown",this.handleKeydown);const e=(0,Yt.KR)(Jt,"topics");(0,Yt.Zy)(e,(e=>{e.exists()&&(this.totalTopics=e.val().length)})),this.updateVoteCounts()},beforeUnmount(){window.removeEventListener("keydown",this.handleKeydown),this.votingResultTimer&&clearTimeout(this.votingResultTimer),this.stopConfetti(),this.audioManager.stopAll()}};const Ws=(0,c.A)(Ds,[["render",Vs],["__scopeId","data-v-14b19800"]]);var qs=Ws,Ks={name:"BoardView",components:{VotingTopic:ns,VotingResult:Cs,IndividualResult:Ps,StatusPanel:qs},props:{sessionId:{type:String,required:!0}},setup(e){const t=(0,m.rd)(),{topics:s}=ss(),a=(0,ke.KR)(!1),i=(0,ke.KR)(.9),n=(0,ke.KR)(null),l=(0,ke.KR)("waiting"),r=(0,ke.KR)({}),c=(0,ke.KR)(1),u=(0,o.EW)((()=>{const e={};return Object.values(r.value).forEach((t=>{e[t.option]=(e[t.option]||0)+1})),e})),d=(0,o.EW)((()=>Object.values(r.value).filter((e=>"Za"===e.option)).length)),h=(0,o.EW)((()=>Object.values(r.value).filter((e=>"Przeciw"===e.option)).length)),p=(0,o.EW)((()=>Object.values(r.value).filter((e=>"Wstrzymuję się"===e.option)).length)),v=(0,o.EW)((()=>{if("Wyniki"!==l.value)return null;const e={ZA:0,PRZECIW:0,"WSTRZYMANO SIĘ":0};return Object.values(r.value).forEach((t=>{t.option in e&&e[t.option]++})),e})),g=async()=>{await(0,Xt.hZ)((0,Xt.KR)(Jt,`sessions/${e.sessionId}/status`),"Pierwsze czytanie"),await(0,Xt.hZ)((0,Xt.KR)(Jt,`sessions/${e.sessionId}/currentTopic`),{number:1}),await(0,Xt.hZ)((0,Xt.KR)(Jt,`sessions/${e.sessionId}/votes`),{}),t.push("/")},f=t=>{console.log("Zmieniono etap na:",t),l.value=t,(0,Xt.hZ)((0,Xt.KR)(Jt,`sessions/${e.sessionId}/status`),t),"Podsumowanie"===t&&c.value>=s.value.length&&(a.value=!0)},y=async()=>{await(0,Xt.hZ)((0,Xt.KR)(Jt,`sessions/${e.sessionId}/status`),"Głosowanie")},b=async()=>{await(0,Xt.hZ)((0,Xt.KR)(Jt,`sessions/${e.sessionId}/status`),"Wyniki")},w=async()=>{await(0,Xt.hZ)((0,Xt.KR)(Jt,`sessions/${e.sessionId}/status`),"Pierwsze czytanie"),await(0,Xt.hZ)((0,Xt.KR)(Jt,`sessions/${e.sessionId}/votes`),{}),k()},k=async()=>{const t={text:"Przykładowe pytanie?",options:["Za","Przeciw","Wstrzymuję się"]};await(0,Xt.hZ)((0,Xt.KR)(Jt,`sessions/${e.sessionId}/currentQuestion`),t)};return(0,o.sV)((()=>{const t=(0,Xt.KR)(Jt,`sessions/${e.sessionId}/currentQuestion`),s=(0,Xt.KR)(Jt,`sessions/${e.sessionId}/status`),a=(0,Xt.KR)(Jt,`sessions/${e.sessionId}/votes`),o=(0,Xt.KR)(Jt,`sessions/${e.sessionId}/currentTopic`);(0,Xt.Zy)(o,(e=>{const t=e.val();t&&(c.value=t.number||1)})),(0,Xt.Zy)(t,(e=>{n.value=e.val()})),(0,Xt.Zy)(s,(e=>{const t=e.val()||"Pierwsze czytanie";console.log("Firebase status changed:",t),l.value=t}));const i=(0,Xt.KR)(Jt,`sessions/${e.sessionId}/status`);(0,Xt.Jt)(i).then((e=>{e.exists()||(0,Xt.hZ)(i,"Pierwsze czytanie")})),(0,Xt.Zy)(a,(e=>{r.value=e.val()||{}}))})),{contentOpacity:i,currentQuestion:n,gameStage:l,voteResults:u,votes:r,votesFor:d,votesAgainst:h,votesAbstain:p,currentTopicNumber:c,collectiveVotes:v,handleStageChange:f,startVoting:y,showResults:b,nextQuestion:w,loadNextQuestion:k,showEndGameDialog:a,goToStart:g}}};const js=(0,c.A)(Ks,[["render",Qt],["__scopeId","data-v-37823558"]]);var Os=js,Ms=s.p+"img/real-voting.6a92c9c0.png",$s=s(5126),Qs=s(6106),Zs=s(4366),Gs=s(8050);const Xs={key:0,class:"mb-6"},Us={key:1},Hs={class:"d-flex flex-column align-center"},Js=["href"];function Ys(e,t,s,i,n,l){const r=(0,o.g2)("qrcode-vue");return(0,o.uX)(),(0,o.Wv)(L.I,{class:"fill-height pa-0"},{default:(0,o.k6)((()=>[(0,o.bF)(F.L,{align:"center",justify:"center",class:"fill-height ma-0"},{default:(0,o.k6)((()=>[(0,o.bF)(_.B,{cols:"12",lg:"10",xl:"8",class:"pa-4"},{default:(0,o.k6)((()=>[(0,o.bF)(T.J,{class:"elevation-12 fill-height"},{default:(0,o.k6)((()=>[(0,o.bF)(Zs.u,{color:"primary",dark:"",flat:""},{default:(0,o.k6)((()=>[(0,o.bF)(Gs.s,{class:"text-h5"},{default:(0,o.k6)((()=>t[0]||(t[0]=[(0,o.eW)("Gra Polityczna")]))),_:1})])),_:1}),(0,o.bF)(K.O,{class:"pa-6"},{default:(0,o.k6)((()=>[(0,o.bF)(F.L,{class:"fill-height"},{default:(0,o.k6)((()=>[(0,o.bF)(_.B,{cols:"6",class:"text-center d-flex flex-column justify-center"},{default:(0,o.k6)((()=>[t[1]||(t[1]=(0,o.Lk)("h2",{class:"text-h4 mb-8"},"Dołącz do gry!",-1)),i.sessionId?((0,o.uX)(),(0,o.CE)("div",Xs,[(0,o.bF)(r,{value:i.joinUrl,size:280,level:"H"},null,8,["value"])])):((0,o.uX)(),(0,o.CE)("div",Us,[(0,o.bF)(Qs.x,{indeterminate:"",color:"primary",size:"64"})])),(0,o.Lk)("div",Hs,[i.sessionId?((0,o.uX)(),(0,o.CE)("a",{key:0,href:i.joinUrl,target:"_blank",class:"mb-4 text-decoration-none text-body-1"},(0,E.v_)(i.joinUrl),9,Js)):(0,o.Q3)("",!0)])])),_:1}),(0,o.bF)(_.B,{cols:"6",class:"d-flex flex-column align-center justify-center"},{default:(0,o.k6)((()=>[(0,o.bF)($s.y,{src:Ms,alt:"Prawdziwy system głosowania",class:"real-voting-image mb-4","max-height":"400",contain:""}),t[2]||(t[2]=(0,o.Lk)("em",{class:"text-h6"},"Prawdziwy system do głosowania w sejmie",-1))])),_:1})])),_:1}),(0,o.bF)(F.L,{class:"mt-8"},{default:(0,o.k6)((()=>[(0,o.bF)(_.B,{cols:"6",class:"text-center"},{default:(0,o.k6)((()=>[(0,o.bF)(h.D,{color:"secondary",onClick:i.goToSettings,"min-width":"250",height:"50",class:"text-h6"},{default:(0,o.k6)((()=>t[3]||(t[3]=[(0,o.eW)(" Ustawienia ")]))),_:1},8,["onClick"])])),_:1}),(0,o.bF)(_.B,{cols:"6",class:"text-center"},{default:(0,o.k6)((()=>[(0,o.bF)(h.D,{color:"primary",onClick:i.goToBoard,onKeyup:(0,a.jR)(i.goToBoard,["enter"]),"min-width":"250",height:"50",class:"text-h6"},{default:(0,o.k6)((()=>t[4]||(t[4]=[(0,o.eW)(" Rozpocznij obrady ")]))),_:1},8,["onClick","onKeyup"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}var ea=s(9877);const ta=async()=>{const e=Math.random().toString(36).substring(2,15),t=(0,Xt.KR)(Jt,`sessions/${e}`);return await(0,Xt.hZ)(t,{createdAt:Date.now(),status:"waiting",currentQuestion:null,votes:{},deputies:{}}),e};var sa={name:"PoliticsStartView",components:{QrcodeVue:ea.Ay},setup(){const e=(0,m.rd)(),t=(0,ke.KR)(null),s=(0,o.EW)((()=>t.value?`${window.location.origin}/mirsan-quiz/#/join-game/${t.value}`:"")),a=()=>{t.value&&e.push(`/politics/board/${t.value}`)},i=()=>{e.push("/politics/settings")};return(0,o.sV)((async()=>{t.value=await ta()})),{sessionId:t,joinUrl:s,goToBoard:a,goToSettings:i}}};const aa=(0,c.A)(sa,[["render",Ys],["__scopeId","data-v-44c22206"]]);var oa=aa;const ia={class:"politician-panel-view"},na={key:0},la={key:1,class:"rotate-message"};function ra(e,t,s,a,i,n){const l=(0,o.g2)("VotingPanel");return(0,o.uX)(),(0,o.CE)("div",ia,[a.isLandscape?((0,o.uX)(),(0,o.CE)("div",na,[(0,o.bF)(l,{"deputy-name":s.deputyName,"vote-id":a.currentTopicNumber,"session-id":s.sessionId,onVoteCast:a.handleVote,disabled:!a.canVote},null,8,["deputy-name","vote-id","session-id","onVoteCast","disabled"])])):((0,o.uX)(),(0,o.CE)("div",la,[(0,o.bF)(Se.w,{size:"64",class:"mb-4"},{default:(0,o.k6)((()=>t[0]||(t[0]=[(0,o.eW)("mdi-rotate-right")]))),_:1}),t[1]||(t[1]=(0,o.Lk)("div",{class:"text-h6"},"Odwróć telefon by uruchomić Panel do głosowania",-1))]))])}const ca={class:"voting-panel-container"},ua={class:"d-flex align-center"},da={class:"deputy-name"},ma={class:"vote-result-display"},ha={key:0,class:"text-h1 vote-text"},pa={class:"button-container"};function va(e,t,s,a,i,n){return(0,o.uX)(),(0,o.Wv)(L.I,{fluid:"",class:"pa-0"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",ca,[(0,o.bF)(T.J,{class:"voting-card",elevation:"4"},{default:(0,o.k6)((()=>[(0,o.bF)(_e.r,{class:"header-bar d-flex justify-space-between align-center pa-2"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",ua,[(0,o.bF)(Se.w,{icon:"mdi-card-account-details",class:"mr-2"}),(0,o.Lk)("span",da,(0,E.v_)(s.deputyName),1)]),(0,o.Lk)("div",null,[(0,o.bF)(h.D,{icon:"",variant:"text",onClick:n.toggleContrast},{default:(0,o.k6)((()=>[(0,o.bF)(Se.w,null,{default:(0,o.k6)((()=>t[3]||(t[3]=[(0,o.eW)("mdi-contrast-circle")]))),_:1})])),_:1},8,["onClick"])])])),_:1}),(0,o.bF)(K.O,{class:"vote-container pa-2"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",ma,[(0,o.Lk)("div",{class:(0,E.C4)(["vote-number",{"vote-number-white":i.currentVote}])}," Głosowanie nr "+(0,E.v_)(s.voteId),3),(0,o.Lk)("div",{class:(0,E.C4)(["vote-result",n.voteResultClass])},[i.currentVote?((0,o.uX)(),(0,o.CE)("span",ha," Głos: "+(0,E.v_)(i.currentVote),1)):(0,o.Q3)("",!0)],2)])])),_:1}),(0,o.bF)(xe.S,{class:"button-panel pa-2"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",pa,[(0,o.bF)(h.D,{class:"vote-btn vote-for",size:"x-large",onClick:t[0]||(t[0]=e=>n.vote("ZA")),disabled:!!i.currentVote||s.disabled},{default:(0,o.k6)((()=>t[4]||(t[4]=[(0,o.eW)(" Za ")]))),_:1},8,["disabled"]),(0,o.bF)(h.D,{class:"vote-btn vote-against",size:"x-large",onClick:t[1]||(t[1]=e=>n.vote("PRZECIW")),disabled:!!i.currentVote||s.disabled},{default:(0,o.k6)((()=>t[5]||(t[5]=[(0,o.eW)(" Przeciw ")]))),_:1},8,["disabled"]),(0,o.bF)(h.D,{class:"vote-btn vote-abstain",size:"x-large",onClick:t[2]||(t[2]=e=>n.vote("WSTRZYMANO SIĘ")),disabled:!!i.currentVote||s.disabled},{default:(0,o.k6)((()=>t[6]||(t[6]=[(0,o.Lk)("span",{class:"d-none d-sm-flex"},"Wstrzymaj się",-1),(0,o.Lk)("span",{class:"d-flex d-sm-none"},"Wstrzymaj",-1)]))),_:1},8,["disabled"])])])),_:1})])),_:1})])])),_:1})}var ga={name:"VotingPanel",props:{deputyName:{type:String,required:!0},voteId:{type:Number,required:!0},disabled:{type:Boolean,default:!1},sessionId:{type:String,required:!0}},data(){return{currentVote:"",highContrast:!1}},computed:{voteResultClass(){return{"vote-result-for":"ZA"===this.currentVote,"vote-result-against":"PRZECIW"===this.currentVote,"vote-result-abstain":"WSTRZYMANO SIĘ"===this.currentVote}}},methods:{vote(e){this.currentVote=e,this.$emit("vote-cast",e)},toggleContrast(){this.highContrast=!this.highContrast},resetVote(){console.log("Resetowanie głosu..."),this.currentVote="",this.$emit("vote-reset")}},mounted(){if(console.log("VotingPanel mounted, sessionId:",this.sessionId),!this.sessionId)return void console.error("Brak sessionId!");const e=(0,Yt.KR)(Jt,`sessions/${this.sessionId}/status`);(0,Yt.Zy)(e,(e=>{const t=e.val();console.log("Zmiana etapu na:",t),"Pierwsze czytanie"===t&&this.resetVote()}),(e=>{console.error("Błąd nasłuchiwania etapu:",e)}));const t=(0,Yt.KR)(Jt,`sessions/${this.sessionId}/votes/${this.deputyName}`);(0,Yt.Zy)(t,(e=>{const t=e.val();console.log("Zmiana głosu:",t),t?this.currentVote=t.option:this.resetVote()}),(e=>{console.error("Błąd nasłuchiwania głosu:",e)}))}};const fa=(0,c.A)(ga,[["render",va],["__scopeId","data-v-9e7c6dce"]]);var ya=fa,ba={name:"PoliticianPanelView",components:{VotingPanel:ya},props:{sessionId:{type:String,required:!0},deputyName:{type:String,required:!0}},setup(e){const t=(0,ke.KR)(""),s=(0,ke.KR)(1),a=(0,ke.KR)(!1),i=(0,ke.KR)(!1),{topics:n,loadTopics:l,setupTopicsListener:r}=ss(),c=(0,o.EW)((()=>{console.log("Computing current topic:",{currentTopicNumber:s.value,topics:n.value});const e=(s.value||1)-1,t=n.value[e];return console.log("Selected topic:",t),t||"Brak tematu"})),u=(0,o.EW)((()=>"Głosowanie"===t.value&&!a.value)),d=async o=>{if(u.value)try{const t=(0,Yt.KR)(Jt,`sessions/${e.sessionId}/votes/${e.deputyName}`);await(0,Yt.hZ)(t,{option:o,timestamp:Date.now(),topicNumber:s.value}),console.log("Vote recorded successfully:",{choice:o,deputy:e.deputyName}),a.value=!0}catch(i){console.error("Error recording vote:",i)}else console.log("Cannot vote:",{stage:t.value,hasVoted:a.value})},m=()=>{i.value=window.innerWidth>window.innerHeight};return(0,o.sV)((async()=>{m(),window.addEventListener("resize",m),r(),await l();const o=(0,Yt.KR)(Jt,`sessions/${e.sessionId}/status`);(0,Yt.Zy)(o,(e=>{const s=e.val();console.log("Stage changed to:",s),t.value=s,"Głosowanie"!==s&&(a.value=!1)}));const i=(0,Yt.KR)(Jt,`sessions/${e.sessionId}/currentTopic`);(0,Yt.Zy)(i,(e=>{const t=e.val();t&&(console.log("Topic changed to:",t),s.value=t.number||1,a.value=!1)}));const n=(0,Yt.KR)(Jt,`sessions/${e.sessionId}/votes/${e.deputyName}`);(0,Yt.Zy)(n,(e=>{const t=e.val();t&&t.topicNumber===s.value&&(console.log("Already voted in this topic:",t),a.value=!0)}))})),{gameStage:t,currentTopicNumber:s,currentTopic:c,hasVoted:a,canVote:u,handleVote:d,isLandscape:i}}};const wa=(0,c.A)(ba,[["render",ra],["__scopeId","data-v-60f94c18"]]);var ka=wa,Ca=s(1720);function Ta(e,t,s,i,n,l){return(0,o.uX)(),(0,o.Wv)(L.I,{class:"fill-height"},{default:(0,o.k6)((()=>[(0,o.bF)(F.L,{align:"center",justify:"center"},{default:(0,o.k6)((()=>[(0,o.bF)(_.B,{cols:"12",sm:"8",md:"6"},{default:(0,o.k6)((()=>[(0,o.bF)(T.J,{class:"elevation-12"},{default:(0,o.k6)((()=>[(0,o.bF)(Zs.u,{color:"primary",dark:"",flat:""},{default:(0,o.k6)((()=>[(0,o.bF)(Gs.s,null,{default:(0,o.k6)((()=>t[1]||(t[1]=[(0,o.eW)("Dołącz do gry")]))),_:1})])),_:1}),(0,o.bF)(K.O,null,{default:(0,o.k6)((()=>[(0,o.bF)(ft.n,{onSubmit:(0,a.D$)(i.joinGame,["prevent"])},{default:(0,o.k6)((()=>[(0,o.bF)(bt.W,{modelValue:i.deputyName,"onUpdate:modelValue":t[0]||(t[0]=e=>i.deputyName=e),label:"Imię (imiona) i nazwisko posła",name:"deputyName","prepend-icon":"mdi-account",type:"text",required:""},null,8,["modelValue"])])),_:1},8,["onSubmit"])])),_:1}),(0,o.bF)(xe.S,null,{default:(0,o.k6)((()=>[(0,o.bF)(Ca.h),(0,o.bF)(h.D,{color:"primary",onClick:i.joinGame},{default:(0,o.k6)((()=>t[2]||(t[2]=[(0,o.eW)("Wejdź do sejmu")]))),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}var La={name:"JoinGameView",props:{sessionId:{type:String,required:!0}},setup(e){console.log("Session ID:",e.sessionId);const t=(0,m.rd)(),s=(0,ke.KR)(""),a=(0,ke.KR)(!1),o=(0,ke.KR)("waiting"),i=async()=>{if(console.log("Join game clicked"),!s.value)return void console.log("No deputy name provided");const a=(0,Xt.KR)(Jt,`sessions/${e.sessionId}/deputies/${Date.now()}`);await(0,Xt.hZ)(a,{name:s.value,joinedAt:Date.now()}),console.log("Deputy added:",s.value),t.push({name:"PoliticianPanel",params:{sessionId:e.sessionId,deputyName:s.value}}).then((()=>{console.log("Navigated to PoliticianPanel")})).catch((e=>{console.error("Navigation error:",e)}))};return{deputyName:s,joinGame:i,hasVoted:a,gameStage:o}}};const Fa=(0,c.A)(La,[["render",Ta]]);var _a=Fa,xa=s(266),Sa=s(7009),za=s(4718);const Pa={class:"topic-number"},Na={key:1,class:"text-center my-4"};function Aa(e,t,s,a,i,n){const l=(0,o.g2)("draggable");return(0,o.uX)(),(0,o.Wv)(L.I,{fluid:"",class:"fill-height pa-4"},{default:(0,o.k6)((()=>[(0,o.bF)(F.L,{justify:"center"},{default:(0,o.k6)((()=>[(0,o.bF)(_.B,{cols:"12",md:"8",lg:"6"},{default:(0,o.k6)((()=>[(0,o.bF)(T.J,{class:"elevation-8"},{default:(0,o.k6)((()=>[(0,o.bF)(Zs.u,{color:"primary",dark:"",flat:""},{default:(0,o.k6)((()=>[(0,o.bF)(Gs.s,null,{default:(0,o.k6)((()=>t[1]||(t[1]=[(0,o.eW)("Ustawienia tematów")]))),_:1})])),_:1}),(0,o.bF)(K.O,{class:"pa-4"},{default:(0,o.k6)((()=>[a.topics?((0,o.uX)(),(0,o.Wv)(Sa.x8,{key:0,class:"topics-container mb-4"},{default:(0,o.k6)((()=>[(0,o.bF)(l,{modelValue:a.topics,"onUpdate:modelValue":t[0]||(t[0]=e=>a.topics=e),"item-key":"index",onEnd:a.handleDragEnd,handle:".drag-handle"},{item:(0,o.k6)((({element:e,index:t})=>[(0,o.bF)(za.g,{class:"topic-row"},{prepend:(0,o.k6)((()=>[(0,o.Lk)("div",Pa,(0,E.v_)(t+1)+".",1),(0,o.bF)(Se.w,{class:"drag-handle",icon:"mdi-drag",color:"grey"})])),append:(0,o.k6)((()=>[(0,o.bF)(h.D,{icon:"mdi-delete",color:"error",variant:"text",density:"compact",onClick:e=>a.deleteTopic(t)},null,8,["onClick"])])),default:(0,o.k6)((()=>[(0,o.bF)(bt.W,{"model-value":e,"onUpdate:modelValue":e=>a.updateTopicText(t,e),"hide-details":"",density:"compact",variant:"outlined",class:"topic-input mx-2",placeholder:"Wpisz temat..."},null,8,["model-value","onUpdate:modelValue"])])),_:2},1024)])),_:1},8,["modelValue","onEnd"])])),_:1})):(0,o.Q3)("",!0),a.topics?.length?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",Na,[(0,o.bF)(xa.l,{type:"info",variant:"tonal"},{default:(0,o.k6)((()=>t[2]||(t[2]=[(0,o.eW)(" Lista tematów jest pusta. Dodaj nowy temat. ")]))),_:1})])),(0,o.bF)(h.D,{color:"primary","prepend-icon":"mdi-plus",class:"mb-4",block:"",onClick:a.addNewTopic},{default:(0,o.k6)((()=>t[3]||(t[3]=[(0,o.eW)(" Dodaj nowy temat ")]))),_:1},8,["onClick"]),(0,o.bF)(h.D,{color:"secondary","prepend-icon":"mdi-arrow-left",block:"",onClick:a.goBack},{default:(0,o.k6)((()=>t[4]||(t[4]=[(0,o.eW)(" Powrót do menu ")]))),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})}var Ea=s(1527),Ia=s.n(Ea),Ra={name:"PoliticsSettingsView",components:{draggable:Ia()},setup(){const e=(0,m.rd)(),{topics:t,loadTopics:s,saveTopics:a,setupTopicsListener:i}=ss(),n=(0,o.EW)({get:()=>t.value||[],set:e=>{t.value=e}}),l=async(e,t)=>{const s=[...n.value];s[e]=t,await a(s)},r=async e=>{try{const t=[...n.value],s=t.filter(((t,s)=>s!==e));await a(s)}catch(t){console.error("Error deleting topic:",t)}},c=async()=>{try{const e=[...n.value],t=[...e,"Nowy temat"];await a(t)}catch(e){console.error("Error adding new topic:",e)}},u=async()=>{try{await a(n.value)}catch(e){console.error("Error saving topics after drag:",e)}},d=()=>{e.push("/politics")};return(0,o.sV)((async()=>{try{i(),await s()}catch(e){console.error("Error in setup:",e)}})),{topics:n,updateTopicText:l,deleteTopic:r,addNewTopic:c,handleDragEnd:u,goBack:d}}};const Ba=(0,c.A)(Ra,[["render",Aa],["__scopeId","data-v-467e895f"]]);var Va=Ba;const Da=[{path:"/",name:"home",component:k},{path:"/family",name:"family",component:ct,beforeEnter:(e,t,s)=>{const a=localStorage.getItem("familyGameConfig");a?s():s("/start-family")}},{path:"/start-family",name:"start-family",component:Pt},{path:"/family/host",name:"family-host",component:Mt,beforeEnter:(e,t,s)=>{const a=localStorage.getItem("familyGameConfig");a?s():s("/start-family")}},{path:"/",redirect:"/start-family"},{path:"/politics",name:"politics-start",component:oa},{path:"/politics/board/:sessionId",name:"politics-board",component:Os,props:!0},{path:"/join-game/:sessionId",name:"join-game",component:_a,props:!0},{path:"/politician-panel/:sessionId/:deputyName",name:"PoliticianPanel",component:ka,props:!0},{path:"/politics/settings",name:"politics-settings",component:Va}],Wa=(0,m.aE)({history:(0,m.Bt)(),routes:Da});Wa.beforeEach(((e,t,s)=>{"/family"===e.path&&"/"===t.path?s("/start-family"):s()}));var qa=Wa,Ka=(s(5524),s(5790)),ja=(0,Ka.$N)();const Oa=()=>{const e=new FontFace("PixelFont","url(./assets/fonts/PixelFont.ttf)"),t=new FontFace("DigitalFont","url(./assets/fonts/DigitalFont.ttf)");Promise.all([e.load(),t.load()]).then((e=>{e.forEach((e=>{document.fonts.add(e)}))})).catch((e=>{console.error("Nie udało się załadować czcionek:",e)}))};Oa(),as().catch((e=>{console.error("Nie udało się zainicjalizować tematów:",e)})),(0,a.Ef)(d).use(qa).use(ja).mount("#app")},6178:function(e,t,s){e.exports=s.p+"img/logo.4b40de14.jpg"}},t={};function s(a){var o=t[a];if(void 0!==o)return o.exports;var i=t[a]={exports:{}};return e[a].call(i.exports,i,i.exports,s),i.exports}s.m=e,function(){var e=[];s.O=function(t,a,o,i){if(!a){var n=1/0;for(u=0;u<e.length;u++){a=e[u][0],o=e[u][1],i=e[u][2];for(var l=!0,r=0;r<a.length;r++)(!1&i||n>=i)&&Object.keys(s.O).every((function(e){return s.O[e](a[r])}))?a.splice(r--,1):(l=!1,i<n&&(n=i));if(l){e.splice(u--,1);var c=o();void 0!==c&&(t=c)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[a,o,i]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){s.p="/mirsan-quiz/"}(),function(){var e={524:0};s.O.j=function(t){return 0===e[t]};var t=function(t,a){var o,i,n=a[0],l=a[1],r=a[2],c=0;if(n.some((function(t){return 0!==e[t]}))){for(o in l)s.o(l,o)&&(s.m[o]=l[o]);if(r)var u=r(s)}for(t&&t(a);c<n.length;c++)i=n[c],s.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return s.O(u)},a=self["webpackChunkmirsan_quiz"]=self["webpackChunkmirsan_quiz"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=s.O(void 0,[504],(function(){return s(469)}));a=s.O(a)})();
//# sourceMappingURL=app.5191d165.js.map